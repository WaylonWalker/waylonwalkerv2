{"componentChunkName":"component---src-templates-blog-post-js","path":"/kedro-catalog/","result":{"data":{"markdownRemark":{"id":"ddd58cc6-642a-5281-a8b7-0116394091ed","html":"<p>I am exploring a kedro catalog meta data hook, these are some notes about what I am thinking.</p>\n<h2>Process</h2>\n<ul>\n<li>metadata will be attached to the dataset object under a <code class=\"language-text\">.metadata</code> attribute</li>\n<li>metadata will be updated <code class=\"language-text\">after_node_run</code></li>\n<li>metadata will be empty until a pipeline is ran with the hook on</li>\n<li>optionally a function to add metadata will be added</li>\n<li>metadata will be stored in a file next to the <code class=\"language-text\">filepath</code></li>\n<li>meta</li>\n</ul>\n<h2>Problems This Hook Should solve</h2>\n<ul>\n<li>what datasets have a columns with <code class=\"language-text\">sales</code> in the name</li>\n<li>what datasets were updated after last tuesday</li>\n<li>which pipeline node created this dataset</li>\n<li>how many rows are in this dataset (without reloading all datasets)</li>\n</ul>\n<h2>implementation details</h2>\n<ul>\n<li>metadata will be attached to each dataset as a dictionary</li>\n<li>list/dict comprehensions can be used to make queries</li>\n</ul>\n<h2>Metadata to Capture</h2>\n<p>try pandas method -> try spark -> try dict/list -> none</p>\n<ul>\n<li>column names</li>\n<li>length</li>\n<li>Null count</li>\n<li>created_by node name</li>\n</ul>\n<h2>Database?</h2>\n<p>Is there an easy way to create a nosql database in memory from a a list of dictionaries?</p>\n<ul>\n<li><a href=\"https://pypi.org/project/list-dict-DB/\">list-dict-DB</a></li>\n<li><a href=\"https://dataset.readthedocs.io/en/latest/\">dataset</a></li>\n<li><a href=\"https://tinydb.readthedocs.io/en/latest/\">TinyDB</a></li>\n</ul>","fields":{"slug":"/kedro-catalog/"},"frontmatter":{"date":"2020-07-24T05:00:00.000Z","title":"Kedro Catalog","description":"I am exploring a kedro catalog meta data hook","status":"published","cover":{"absolutePath":"/home/runner/work/waylonwalkerv2/waylonwalkerv2/static/kedro-catalog-xmas2020.png","xsm_img":{"fixed":{"src":"/static/67e22418f2d6ba5fedf80b11395eecfd/ef958/kedro-catalog-xmas2020.png","srcWebp":"/static/67e22418f2d6ba5fedf80b11395eecfd/f6b6d/kedro-catalog-xmas2020.webp"}},"sm_img":{"fixed":{"src":"/static/67e22418f2d6ba5fedf80b11395eecfd/630fb/kedro-catalog-xmas2020.png","srcWebp":"/static/67e22418f2d6ba5fedf80b11395eecfd/403a4/kedro-catalog-xmas2020.webp"}},"med_img":{"fixed":{"src":"/static/67e22418f2d6ba5fedf80b11395eecfd/46604/kedro-catalog-xmas2020.png","srcWebp":"/static/67e22418f2d6ba5fedf80b11395eecfd/e9589/kedro-catalog-xmas2020.webp"}},"full":{"fixed":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAABsElEQVQY02OQUTEEIVVjWVUjaRUDIFsayFXSl1TWl1TSV9Iw1dSx1dNz0NOz09e30TO0NdC31DO00je00Dc0Y5BSMZRUMRSW1RKR15FWNZJUMZBQ1AMJKhvIq5nJK5pJKOjr6jvo6tnp6tnq6FoZGNnoG1rpGJjrGYA1iyvo+ocl2LkHCUhpiMrryGua8kuqC0prisnpZudWufqEy8gZ6ujZa+tam5g5Kanoa2ib6BpYgDQD3cknq7V2266axo6M/PLo5Jxlq9bnFFeHxqSZO3jPW7wiI6+8ublvxoyFPb1TFy1eUVZel51brKVrom9oziCsbKghodZZVF5a3947cXpL54TZ85ek5pSU17bIqpvUt/S0907u65/RP2Hm1Glzly1fM2Pm/K6eSVq6piDNChoGWzub6yPSuKQ0BKWBSFNIRlMAzBCV1wX6AsgQl9NVVTdX0zBXUDYwMrZ38wzUhmjW09efVh7ta+MvLK8ro2oEDAI4AoYZEEEYihpmRgaO1qau9iZuFgb2tibOyuomDKKKepIK2pKKuhJK+niQuKK+FNAIdRNVLTMlTVNgRAJFAI/3c7XiT04bAAAAAElFTkSuQmCC","width":1000,"height":420,"src":"/static/67e22418f2d6ba5fedf80b11395eecfd/a8734/kedro-catalog-xmas2020.png","srcSet":"/static/67e22418f2d6ba5fedf80b11395eecfd/a8734/kedro-catalog-xmas2020.png 1x"},"fluid":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAABsElEQVQY02OQUTEEIVVjWVUjaRUDIFsayFXSl1TWl1TSV9Iw1dSx1dNz0NOz09e30TO0NdC31DO00je00Dc0Y5BSMZRUMRSW1RKR15FWNZJUMZBQ1AMJKhvIq5nJK5pJKOjr6jvo6tnp6tnq6FoZGNnoG1rpGJjrGYA1iyvo+ocl2LkHCUhpiMrryGua8kuqC0prisnpZudWufqEy8gZ6ujZa+tam5g5Kanoa2ib6BpYgDQD3cknq7V2266axo6M/PLo5Jxlq9bnFFeHxqSZO3jPW7wiI6+8ublvxoyFPb1TFy1eUVZel51brKVrom9oziCsbKghodZZVF5a3947cXpL54TZ85ek5pSU17bIqpvUt/S0907u65/RP2Hm1Glzly1fM2Pm/K6eSVq6piDNChoGWzub6yPSuKQ0BKWBSFNIRlMAzBCV1wX6AsgQl9NVVTdX0zBXUDYwMrZ38wzUhmjW09efVh7ta+MvLK8ro2oEDAI4AoYZEEEYihpmRgaO1qau9iZuFgb2tibOyuomDKKKepIK2pKKuhJK+niQuKK+FNAIdRNVLTMlTVNgRAJFAI/3c7XiT04bAAAAAElFTkSuQmCC","aspectRatio":2.380952380952381,"src":"/static/67e22418f2d6ba5fedf80b11395eecfd/a8734/kedro-catalog-xmas2020.png","srcSet":"/static/67e22418f2d6ba5fedf80b11395eecfd/2d6f8/kedro-catalog-xmas2020.png 250w,\n/static/67e22418f2d6ba5fedf80b11395eecfd/03ac3/kedro-catalog-xmas2020.png 500w,\n/static/67e22418f2d6ba5fedf80b11395eecfd/a8734/kedro-catalog-xmas2020.png 1000w","sizes":"(max-width: 1000px) 100vw, 1000px"}}}}}},"pageContext":{"id":"ddd58cc6-642a-5281-a8b7-0116394091ed","prev":{"id":"e229999a-a515-5f36-8fc0-39579ab29605","html":"<p>kedro 0.16.2 just dropped last week with a long-awaited feature... <strong>catalog search</strong>!  I went as far as monkey patching this into each of my projects.  I work jump between a few really big projects that have tons of datasets.  Being able to quickly search for what I need is so useful.</p>\n<h2>The Catalog</h2>\n<p>The kedro data catalog is a key component to the kedro framework.  It handles all data loading and saving for you.  It is configurable and hackable.  Having all your data connections listed in one place make it so easy to pick your project up and move it to a completely new environment.  That sweet imperative loading style saves so much read/write overhead.  I can load all my data with a single command whether it's in amazon s3, google cloud platform, or a local file.</p>\n<h2>Kick start a toy project</h2>\n<p>Just like with most of these articles, I am going to create a conda environment so that I don't break any existing projects and scaffold up a toy project to learn from.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">conda create -n kedro0162 <span class=\"token assign-left variable\">python</span><span class=\"token operator\">=</span><span class=\"token number\">3.8</span> -y\nactivate kedro0162\npip <span class=\"token function\">install</span> kedro\nkedro new <span class=\"token comment\"># call it Kedro 0162 and click-through</span>\n<span class=\"token builtin class-name\">cd</span> kedro-0162\nkedro <span class=\"token function\">install</span></code></pre></div>\n<p>Expect this set of commands to take a few minutes depending on your system, connection speed, and amount of packages already in your local cache.</p>\n<h2>Create some catalog</h2>\n<p>Now the power of the catalog search really starts to shine when your projects grow legs.  You have groups of many datasets containing patterns of data including <code class=\"language-text\">layer</code>, or <code class=\"language-text\">source</code> among other things.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">vim</span> conf/base/catalog.yml</code></pre></div>\n<p>In the catalog, you will see a few lines of instructions followed by</p>\n<div class=\"gatsby-highlight\" data-language=\"yml\"><pre class=\"language-yml\"><code class=\"language-yml\"><span class=\"token key atrule\">example_iris_data</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">type</span><span class=\"token punctuation\">:</span> pandas.CSVDataSet\n  <span class=\"token key atrule\">filepath</span><span class=\"token punctuation\">:</span> data/01_raw/iris.csv</code></pre></div>\n<p>This gives us one stored catalog entry called <code class=\"language-text\">example_iris_data</code>, it is a CSV file stored in <code class=\"language-text\">data/01_raw/iris.csv</code>.</p>\n<p>Let's make up a transportation company that is siloed into three different divisions and it is our job to bring their sales and product metadata into a single report.  This company makes <code class=\"language-text\">lifted-trucks</code>, <code class=\"language-text\">primium-scoots</code>, and <code class=\"language-text\">luxy-yahts</code>.  and we know that we will want <code class=\"language-text\">raw</code>, <code class=\"language-text\">int</code>, <code class=\"language-text\">pri</code> and <code class=\"language-text\">modin</code> layers to start our project so let's scaffold up that catalog real quick.</p>\n<div class=\"gatsby-highlight\" data-language=\"yml\"><pre class=\"language-yml\"><code class=\"language-yml\"><span class=\"token comment\"># ――――――――― lifted-truck ―――――――――</span>\n\n<span class=\"token key atrule\">raw_lifted_truck_sales</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">type</span><span class=\"token punctuation\">:</span> pandas.CSVDataSet\n  <span class=\"token key atrule\">filepath</span><span class=\"token punctuation\">:</span> data/01_raw/sales/lifted<span class=\"token punctuation\">-</span>truck.csv\n\n<span class=\"token key atrule\">int_lifted_truck_sales</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">type</span><span class=\"token punctuation\">:</span> pandas.CSVDataSet\n  <span class=\"token key atrule\">filepath</span><span class=\"token punctuation\">:</span> data/01_int/sales/lifted<span class=\"token punctuation\">-</span>truck.csv\n\n<span class=\"token key atrule\">pri_lifted_truck_sales</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">type</span><span class=\"token punctuation\">:</span> pandas.CSVDataSet\n  <span class=\"token key atrule\">filepath</span><span class=\"token punctuation\">:</span> data/01_pri/sales/lifted<span class=\"token punctuation\">-</span>truck.csv\n\n<span class=\"token key atrule\">raw_lifted_truck_info</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">type</span><span class=\"token punctuation\">:</span> pandas.CSVDataSet\n  <span class=\"token key atrule\">filepath</span><span class=\"token punctuation\">:</span> data/01_raw/info/lifted<span class=\"token punctuation\">-</span>truck.csv\n\n<span class=\"token key atrule\">int_lifted_truck_info</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">type</span><span class=\"token punctuation\">:</span> pandas.CSVDataSet\n  <span class=\"token key atrule\">filepath</span><span class=\"token punctuation\">:</span> data/01_int/info/lifted<span class=\"token punctuation\">-</span>truck.csv\n\n<span class=\"token key atrule\">pri_lifted_truck_info</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">type</span><span class=\"token punctuation\">:</span> pandas.CSVDataSet\n  <span class=\"token key atrule\">filepath</span><span class=\"token punctuation\">:</span> data/01_pri/info/lifted<span class=\"token punctuation\">-</span>truck.csv\n\n<span class=\"token comment\"># ――――――――― primium-scoot ―――――――――</span>\n\n<span class=\"token key atrule\">raw_primium_scoot_sales</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">type</span><span class=\"token punctuation\">:</span> pandas.CSVDataSet\n  <span class=\"token key atrule\">filepath</span><span class=\"token punctuation\">:</span> data/01_raw/sales/primium<span class=\"token punctuation\">-</span>scoot.csv\n\n<span class=\"token key atrule\">int_primium_scoot_sales</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">type</span><span class=\"token punctuation\">:</span> pandas.CSVDataSet\n  <span class=\"token key atrule\">filepath</span><span class=\"token punctuation\">:</span> data/01_int/sales/primium<span class=\"token punctuation\">-</span>scoot.csv\n\n<span class=\"token key atrule\">pri_primium_scoot_sales</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">type</span><span class=\"token punctuation\">:</span> pandas.CSVDataSet\n  <span class=\"token key atrule\">filepath</span><span class=\"token punctuation\">:</span> data/01_pri/sales/primium<span class=\"token punctuation\">-</span>scoot.csv\n\n<span class=\"token key atrule\">raw_primium_scoot_info</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">type</span><span class=\"token punctuation\">:</span> pandas.CSVDataSet\n  <span class=\"token key atrule\">filepath</span><span class=\"token punctuation\">:</span> data/01_raw/info/primium<span class=\"token punctuation\">-</span>scoot.csv\n\n<span class=\"token key atrule\">int_primium_scoot_info</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">type</span><span class=\"token punctuation\">:</span> pandas.CSVDataSet\n  <span class=\"token key atrule\">filepath</span><span class=\"token punctuation\">:</span> data/01_int/info/primium<span class=\"token punctuation\">-</span>scoot.csv\n\n<span class=\"token key atrule\">pri_primium_scoot_info</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">type</span><span class=\"token punctuation\">:</span> pandas.CSVDataSet\n  <span class=\"token key atrule\">filepath</span><span class=\"token punctuation\">:</span> data/01_pri/info/primium<span class=\"token punctuation\">-</span>scoot.csv\n\n<span class=\"token comment\"># ――――――――― luxy-yaht ―――――――――</span>\n\n<span class=\"token key atrule\">raw_luxy_yaht_sales</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">type</span><span class=\"token punctuation\">:</span> pandas.CSVDataSet\n  <span class=\"token key atrule\">filepath</span><span class=\"token punctuation\">:</span> data/01_raw/sales/luxy<span class=\"token punctuation\">-</span>yaht.csv\n\n<span class=\"token key atrule\">int_luxy_yaht_sales</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">type</span><span class=\"token punctuation\">:</span> pandas.CSVDataSet\n  <span class=\"token key atrule\">filepath</span><span class=\"token punctuation\">:</span> data/01_int/sales/luxy<span class=\"token punctuation\">-</span>yaht.csv\n\n<span class=\"token key atrule\">pri_luxy_yaht_sales</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">type</span><span class=\"token punctuation\">:</span> pandas.CSVDataSet\n  <span class=\"token key atrule\">filepath</span><span class=\"token punctuation\">:</span> data/01_pri/sales/luxy<span class=\"token punctuation\">-</span>yaht.csv\n\n<span class=\"token key atrule\">raw_luxy_yaht_info</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">type</span><span class=\"token punctuation\">:</span> pandas.CSVDataSet\n  <span class=\"token key atrule\">filepath</span><span class=\"token punctuation\">:</span> data/01_raw/info/luxy<span class=\"token punctuation\">-</span>yaht.csv\n\n<span class=\"token key atrule\">int_luxy_yaht_info</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">type</span><span class=\"token punctuation\">:</span> pandas.CSVDataSet\n  <span class=\"token key atrule\">filepath</span><span class=\"token punctuation\">:</span> data/01_int/info/luxy<span class=\"token punctuation\">-</span>yaht.csv\n\n<span class=\"token key atrule\">pri_luxy_yaht_info</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">type</span><span class=\"token punctuation\">:</span> pandas.CSVDataSet\n  <span class=\"token key atrule\">filepath</span><span class=\"token punctuation\">:</span> data/01_pri/info/luxy<span class=\"token punctuation\">-</span>yaht.csv\n\n\n<span class=\"token comment\"># ――――――――― combined ―――――――――</span>\n<span class=\"token key atrule\">pri_combined_sales</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">type</span><span class=\"token punctuation\">:</span> pandas.CSVDataSet\n  <span class=\"token key atrule\">filepath</span><span class=\"token punctuation\">:</span> data/01_pri/sales/combined.csv\n\n<span class=\"token key atrule\">pri_combined_info</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">type</span><span class=\"token punctuation\">:</span> pandas.CSVDataSet\n  <span class=\"token key atrule\">filepath</span><span class=\"token punctuation\">:</span> data/01_pri/info/combined.csv\n\n<span class=\"token comment\"># ――――――――― modin ―――――――――</span>\n\n<span class=\"token key atrule\">modin_main</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">type</span><span class=\"token punctuation\">:</span> pandas.CSVDataSet\n  <span class=\"token key atrule\">filepath</span><span class=\"token punctuation\">:</span> data/01_pri/info/combined.csv</code></pre></div>\n<h2>Some examples of common regex uses</h2>\n<p><code class=\"language-text\">regex</code> gets really complicated fast, but these basic examples are very common use cases and will get you a long way without being very complicated.</p>\n<ul>\n<li><code class=\"language-text\">term</code> - all catalog entries that include <code class=\"language-text\">term</code> in the catalog entry</li>\n<li><code class=\"language-text\">^term</code> - all catalog entries that include <code class=\"language-text\">term</code> at the <strong>beginning</strong> of the catalog entry</li>\n<li><code class=\"language-text\">term$</code> - all catalog entries that include <code class=\"language-text\">term</code> at the <strong>end</strong> of the catalog entry</li>\n<li><code class=\"language-text\">term1.*term2</code> - include anything in between <code class=\"language-text\">term1</code> and <code class=\"language-text\">term2</code>.</li>\n<li><code class=\"language-text\">term1|term2</code> - all catalog entries that include <code class=\"language-text\">term1</code> or <code class=\"language-text\">term2</code></li>\n</ul>\n<h2>Let's Search this thing</h2>\n<p>kedro has long included the <code class=\"language-text\">catalog.list()</code> feature that returns a list of all datasets.  Now the <code class=\"language-text\">list</code> command takes in a <code class=\"language-text\">regex_search</code> keyword argument.  By default, it is empty and returns the entire catalog.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kedro ipython</code></pre></div>\n<h2>list out all of the luxy-yahts</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> catalog<span class=\"token punctuation\">.</span><span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span>'luxy_yaht`<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">[</span><span class=\"token string\">'raw_luxy_yaht_sales'</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'int_luxy_yaht_sales'</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'pri_luxy_yaht_sales'</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'raw_luxy_yaht_info'</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'int_luxy_yaht_info'</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'pri_luxy_yaht_info'</span><span class=\"token punctuation\">]</span></code></pre></div>\n<h2>List out data by layer</h2>\n<p>Easy just search for the layer name.</p>\n<h3>raw</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> catalog<span class=\"token punctuation\">.</span><span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span><span class=\"token string\">'raw'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">[</span><span class=\"token string\">'raw_lifted_truck_sales'</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'raw_lifted_truck_info'</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'raw_primium_scoot_sales'</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'raw_primium_scoot_info'</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'raw_luxy_yaht_sales'</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'raw_luxy_yaht_info'</span><span class=\"token punctuation\">]</span></code></pre></div>\n<h3>pri</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"> <span class=\"token operator\">>></span><span class=\"token operator\">></span> catalog<span class=\"token punctuation\">.</span><span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span><span class=\"token string\">'pri'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">[</span><span class=\"token string\">'pri_lifted_truck_sales'</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'pri_lifted_truck_info'</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'raw_primium_scoot_sales'</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'int_primium_scoot_sales'</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'pri_primium_scoot_sales'</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'raw_primium_scoot_info'</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'int_primium_scoot_info'</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'pri_primium_scoot_info'</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'pri_luxy_yaht_sales'</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'pri_luxy_yaht_info'</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'pri_combined_sales'</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'pri_combined_info'</span><span class=\"token punctuation\">]</span></code></pre></div>\n<p>😲 We just included every <code class=\"language-text\">primium-scoot</code> dataset!</p>\n<p>Here we just encountered our first need for <code class=\"language-text\">regex</code>.  I'll be the first to admit that I am really bad at regex, it's incredibly confusing, becomes read-only with much complexity, but is super powerful and used in a lot of places.</p>\n<h2><code class=\"language-text\">^term</code></h2>\n<p><em>beginning of catalog entry</em></p>\n<p>The <code class=\"language-text\">^</code> regex operator searches for catalog entries that include the search term at the very beginning.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"> <span class=\"token operator\">>></span><span class=\"token operator\">></span> catalog<span class=\"token punctuation\">.</span><span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span><span class=\"token string\">'^pri'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">[</span><span class=\"token string\">'pri_lifted_truck_sales'</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'pri_lifted_truck_info'</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'pri_primium_scoot_sales'</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'pri_primium_scoot_info'</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'pri_luxy_yaht_sales'</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'pri_luxy_yaht_info'</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'pri_combined_sales'</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'pri_combined_info'</span><span class=\"token punctuation\">]</span></code></pre></div>\n<h2><code class=\"language-text\">term$</code></h2>\n<p><em>end of catalog entry</em></p>\n<p>The <code class=\"language-text\">$</code> operator is the opposite of the <code class=\"language-text\">^</code> operator.  It means give me all that matches that occur at the end of the catalog entry.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> catalog<span class=\"token punctuation\">.</span><span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span><span class=\"token string\">'info$'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">[</span><span class=\"token string\">'raw_lifted_truck_info'</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'int_lifted_truck_info'</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'pri_lifted_truck_info'</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'raw_primium_scoot_info'</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'int_primium_scoot_info'</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'pri_primium_scoot_info'</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'raw_luxy_yaht_info'</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'int_luxy_yaht_info'</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'pri_luxy_yaht_info'</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'pri_combined_info'</span><span class=\"token punctuation\">]</span></code></pre></div>\n<h2><code class=\"language-text\">term1.*term2</code></h2>\n<p>The <code class=\"language-text\">.*</code> operator in regex means give me all the datasets that include the two terms no matter what is between them.  There is also a <code class=\"language-text\">.?</code> to only allow one character between them.  More often than not I really just want the two patterns to exist in the dataset entry.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> catalog<span class=\"token punctuation\">.</span><span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span><span class=\"token string\">'raw.*info$'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">[</span><span class=\"token string\">'raw_lifted_truck_info'</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'raw_primium_scoot_info'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">'raw_luxy_yaht_info'</span><span class=\"token punctuation\">]</span></code></pre></div>\n<h2>Some real things that we can do with search</h2>\n<p>Let's look at a few examples beyond the obvious of just searching for the dataset that we want to load.</p>\n<h2>Check Raw Data</h2>\n<p>While migrating pipelines between environments it's important to know if your raw datasets are available.  I will argue that you should also consider looking at <code class=\"language-text\">pipeline.inputs</code> as it cannot lie and gives you a true reading of the pipeline inputs.  But another easy check might be to check all the datasets that the Data Engineers have labeled raw.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>dataset<span class=\"token punctuation\">:</span> catalog<span class=\"token punctuation\">.</span>exists<span class=\"token punctuation\">(</span>dataset<span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> dataset <span class=\"token keyword\">in</span> catalog<span class=\"token punctuation\">.</span><span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span><span class=\"token string\">'^raw'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">{</span><span class=\"token string\">'raw_lifted_truck_sales'</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">False</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'raw_lifted_truck_info'</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">False</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'raw_primium_scoot_sales'</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">False</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'raw_primium_scoot_info'</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">False</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'raw_luxy_yaht_sales'</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">False</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'raw_luxy_yaht_info'</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">False</span><span class=\"token punctuation\">}</span></code></pre></div>\n<p>Since we just created a dummy catalog the data does not exist in this example.</p>\n<h2>Create a new catalog</h2>\n<p>Let's say that we have someone on the team who is from the land division of our company and they want a simplified catalog readily available that does not include any marine data.</p>\n<p>To do this we will need to reach a bit into the kedro internals for the <code class=\"language-text\">DataCatalog</code> class and utilize a new regex operator <code class=\"language-text\">|</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token keyword\">from</span> kedro<span class=\"token punctuation\">.</span>io <span class=\"token keyword\">import</span> DataCatalog\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> land_catalog <span class=\"token operator\">=</span> DataCatalog<span class=\"token punctuation\">(</span>\n    <span class=\"token punctuation\">{</span>\n        dataset<span class=\"token punctuation\">:</span> <span class=\"token builtin\">getattr</span><span class=\"token punctuation\">(</span>catalog<span class=\"token punctuation\">.</span>datasets<span class=\"token punctuation\">,</span> dataset<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">for</span> dataset <span class=\"token keyword\">in</span> catalog<span class=\"token punctuation\">.</span><span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span><span class=\"token string\">'truck|scoot'</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> land_catalog<span class=\"token punctuation\">.</span><span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">[</span><span class=\"token string\">'raw_lifted_truck_sales'</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'int_lifted_truck_sales'</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'pri_lifted_truck_sales'</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'raw_lifted_truck_info'</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'int_lifted_truck_info'</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'pri_lifted_truck_info'</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'raw_primium_scoot_sales'</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'int_primium_scoot_sales'</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'pri_primium_scoot_sales'</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'raw_primium_scoot_info'</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'int_primium_scoot_info'</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'pri_primium_scoot_info'</span><span class=\"token punctuation\">]</span></code></pre></div>\n<h2>regex recap</h2>\n<ul>\n<li><code class=\"language-text\">^term</code> - beginning</li>\n<li><code class=\"language-text\">term$</code> - end</li>\n<li><code class=\"language-text\">term1.*term2</code> - anything in between</li>\n<li><code class=\"language-text\">term1|term2</code> - or</li>\n</ul>","fields":{"slug":"/kedro-catalog-search/"},"frontmatter":{"tags":["kedro","python","data"],"title":"How to find things in your kedro catalog","description":"kedro 0.16.2 just dropped last week with a long-awaited feature... catalog search!  I went as far as monkey patching this into each of my projects.  I work jump between a few really big projects that have tons of datasets.  Being able to quickly search for what I need is so useful.","templateKey":"blog-post","status":"published","date":"2020-06-22T03:00:00.000Z","cover":{"med_img":{"fixed":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAAB4ElEQVQY0xXOSWsTYQDG8bl5sRNN0poMySyZNLO+2+xrZhKnpQ0osVZp3S2CtmIlttCitYKlHhQ9iKBBSsGl0IPQi59ABD14EUG8CJ78Go7wXH/8H4ppYAk4e/tvBysbrERKjMTJFrYSuiqOcUCSPYQ6CCYYxpaVmG7HMSLDjm07IqZHVQXUAs7vX1+WltdIkKmkLeP4+s2VWsuo8JAVDVmLIEwhjE0ztdyubbVzbDmxYfrUKA8VEvz982159f6Hg4+vd9+/GO5+//Fzc+vJ3v7Byf7VMRYAmII8jlNM2ohEkITIDFCOjwlwHPjT/fm5y4vrG9vXllafPR++3HmTTM58+vy1f2ahXNM0mCggknRPgwGAPkAewA4kDsWIuCigkbpGM61DlcZhZpxmJEbAI3WpIqISq9aahoMmImNq1j9rkzT3Ogp0EgHkUGURu03kNkGIp9eTWw+6d3Z628Oph5udwXHUG8SLT7N7r3pbjybX3p14fCE839QQAQ039BzXowqcfvfKjdtzF6GcLniXZszZU+bpHumfs+cDMGGoqadltt51cOaTDOE2VAW2XrVANQ7t/7dLDZz3y4Je4JUjnEpzMs0pR3l1VABFXstX4jW2ZSp6gHAsK7BYLLBcg5PMf2/7d/Csp11QAAAAAElFTkSuQmCC","width":500,"height":210,"src":"/static/3c0e422a72feaff4bd8cee41f1811e34/46604/kedro-catalog-search-xmas2020.png","srcSet":"/static/3c0e422a72feaff4bd8cee41f1811e34/46604/kedro-catalog-search-xmas2020.png 1x,\n/static/3c0e422a72feaff4bd8cee41f1811e34/d8815/kedro-catalog-search-xmas2020.png 1.5x,\n/static/3c0e422a72feaff4bd8cee41f1811e34/31987/kedro-catalog-search-xmas2020.png 2x"}},"childImageSharp":{"fixed":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsTAAALEwEAmpwYAAACE0lEQVQozx2NwWvTUADGcxE9dKvUtkvTJE2btGmS9/JekiZt07w2XXUDoZsKdjq1bDL0UEHHdA6L1VbYWsd6kIHgfyDFgzgUvHgSFUUQEdGLJ/8P4+A7fPz4fnwUK+IcsF8dPH+8+wQ5fpzXYrxabSwwghZmc/GkqgAX6z5ENQyJXahZpdmiSSyH2Dah6AzOAufX7/eDnT0ZV+YXLx6LCHe6A6/RZCQc5wGXNRXNA3oNQmJZvuXULYuYNrECOS7oeVz+++dTf3tvvP/s89dvtzZ733/8fPHy9XC8P5kcyCphJRPqPtAJwjXDrCLDQ0YFmS5Fp5EEy4ut9lL7em+we6+30304fPP23eWrnfv90YePXzL5Ei8VAlmFXh64QK9A3YWoBHGRYkQcF41pTgsn5SMz6SBHExk6h8OCEhUhJ1shNsdk/z9bqD5nNxEiALkAVQCuULRkpJJ5kZVzirvsLK+5q13/5mh2a7PaaRWWdJk88Nd7/vrT04+Gc1uTM+NV74oEbAxyRrlChThte+Xa6FJbkauD+kYwvU06/frGXXIj8EHeWyutnLPOt5wLp+yFpnPWs+Z1IMkiY4IkNZPWtdJJtdiICSCWhhEBTKeUqZQ8xedZ0QxIiJcDclxQRbWoQBdgT1OV6IkIl5yhEhkc5dQoryUyiD5MQsTMYeJpPYCMaAQ9KMEyI9sKKGu6SzMszUn/ABrDhdAXYaL/AAAAAElFTkSuQmCC","width":200,"height":85,"src":"/static/3c0e422a72feaff4bd8cee41f1811e34/71e30/kedro-catalog-search-xmas2020.png","srcSet":"/static/3c0e422a72feaff4bd8cee41f1811e34/71e30/kedro-catalog-search-xmas2020.png 1x,\n/static/3c0e422a72feaff4bd8cee41f1811e34/24123/kedro-catalog-search-xmas2020.png 1.5x,\n/static/3c0e422a72feaff4bd8cee41f1811e34/492a0/kedro-catalog-search-xmas2020.png 2x"}}}}},"next":{"id":"329ed437-2909-59c8-ba25-8667dc624fea","html":"<p>There are two main ways to create kedro hooks, with modules and classes.  Each one still uses the same verbiage as the function/method names.</p>\n<p>Class hooks seem a bit special as they give you a way to configure them so that they are a bit more generally useful.</p>\n<blockquote>\n<h3>What is Kedro 🤔</h3>\n<p>If you are completely unsure what kedro is be sure to check out my <a href=\"https://waylonwalker.com/wike\">what is kedro</a> post</p>\n</blockquote>\n<h2>Installation</h2>\n<p>.create a new environment manager of choice.  Here I will use <code class=\"language-text\">conda</code>. Then we will install <code class=\"language-text\">kedro</code> from pypi.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">conda create -n kedro_class_hooks -y\nconda activate kedro_class_hooks <span class=\"token comment\"># may also be source activate kedro_class_hooks or activate kedro_class_hooks</span>\npip <span class=\"token function\">install</span> kedro</code></pre></div>\n<h2>Create a sample project</h2>\n<blockquote>\n<h3>Kedro new</h3>\n<p>For more details check out my full post on <a href=\"https://waylonwalker.com/knew\">kedro new</a></p>\n</blockquote>\n<p>For this post I really just want a working pipeline as fast as possible.  For this I am going to use iris pipeline that is generated from the <code class=\"language-text\">kedro new</code> command in the cli.  It's <strong>important</strong> that you answer <code class=\"language-text\">y</code> to create an example pipeline.</p>\n<blockquote>\n<h3>Hold On ✋</h3>\n<p>Did you create a separate environment for this?  Please do.</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kedro new</code></pre></div>\n<p>After you run the <code class=\"language-text\">kedro new</code> command it will ask a series of questions.  👇 Here is how I answered them.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">Project Name:\n<span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">=</span>\nPlease enter a human readable name <span class=\"token keyword\">for</span> your new project.\nSpaces and punctuation are allowed.\n <span class=\"token punctuation\">[</span>New Kedro Project<span class=\"token punctuation\">]</span>: Kedro Class Hooks\nRepository Name:\n<span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span>\nPlease enter a directory name <span class=\"token keyword\">for</span> your new project repository.\nAlphanumeric characters, hyphens and underscores are allowed.\nLowercase is recommended.\n <span class=\"token punctuation\">[</span>kedro-class-hooks<span class=\"token punctuation\">]</span>:\nPython Package Name:\n<span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span>\nPlease enter a valid Python package name <span class=\"token keyword\">for</span> your project package.\nAlphanumeric characters and underscores are allowed.\nLowercase is recommended. Package name must start with a letter or underscore.\n <span class=\"token punctuation\">[</span>kedro_class_hooks<span class=\"token punctuation\">]</span>:\nGenerate Example Pipeline:\n<span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span>\nDo you want to generate an example pipeline <span class=\"token keyword\">in</span> your project?\nGood <span class=\"token keyword\">for</span> first-time users. <span class=\"token punctuation\">(</span>default<span class=\"token operator\">=</span>N<span class=\"token punctuation\">)</span>\n <span class=\"token punctuation\">[</span>y/N<span class=\"token punctuation\">]</span>: y\nChange directory to the project generated <span class=\"token keyword\">in</span> /mnt/c/temp/kedro-hooks/\nA best-practice setup includes initialising <span class=\"token function\">git</span> and creating a virtual environment before running <span class=\"token variable\"><span class=\"token variable\">`</span>kedro <span class=\"token function\">install</span><span class=\"token variable\">`</span></span> to <span class=\"token function\">install</span> project-specific dependencies. Refer to the Kedro documentation: https://kedro.readthedocs.io/</code></pre></div>\n<h3>Install the Project</h3>\n<p>Next install the project itself and all of its dependencies with the <code class=\"language-text\">kedro install</code> command.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token builtin class-name\">cd</span> kedro-hooks\nkedro <span class=\"token function\">install</span></code></pre></div>\n<h3>🏃‍♀️ Run the pipeline</h3>\n<p>Before we start developing any hooks lets make sure everything is set up correctly by running the pipeline with <code class=\"language-text\">kedro run</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kedro run</code></pre></div>\n<h2>class hook without <code class=\"language-text\">self</code></h2>\n<p>A kedro class-based hook is a class with methods using the kedro lifecycle names, decorated with <code class=\"language-text\">@hook_impl</code>, If we create a class-based kedro hook without <code class=\"language-text\">self</code> in the method calls, we simply pass the hook class itself into the hooks list. And we are off.  Kedro will call each method as it hits that point in its lifecycle.  It will pass any of the possible arguments, see arguments below.  Each method has a different set of possible arguments.  You don't need to ask for all of them, but I did here so that you could see them.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> kedro<span class=\"token punctuation\">.</span>framework<span class=\"token punctuation\">.</span>hooks <span class=\"token keyword\">import</span> hook_impl\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">debug_hook</span><span class=\"token punctuation\">:</span>\n    <span class=\"token triple-quoted-string string\">\"\"\"debugs all kedro hook points\"\"\"</span>\n\n\t<span class=\"token decorator annotation punctuation\">@staticmethod</span>\n    <span class=\"token decorator annotation punctuation\">@hook_impl</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">before_pipeline_run</span><span class=\"token punctuation\">(</span>run_params<span class=\"token punctuation\">,</span> pipeline<span class=\"token punctuation\">,</span> catalog<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token string\">\"pops into a debugger before pipeline run\"</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'I hooked in right before the pipeline run'</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">if</span> self<span class=\"token punctuation\">.</span>should_before_pipeline_run<span class=\"token punctuation\">:</span>\n            breakpoint<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n\t<span class=\"token decorator annotation punctuation\">@staticmethod</span>\n    <span class=\"token decorator annotation punctuation\">@hook_impl</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">after_pipeline_run</span><span class=\"token punctuation\">(</span>run_params<span class=\"token punctuation\">,</span> pipeline<span class=\"token punctuation\">,</span> catalog<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token string\">\"pops into a debugger after pipeline run\"</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'I hooked in right after the pipeline run'</span><span class=\"token punctuation\">)</span>\n        breakpoint<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n\t<span class=\"token decorator annotation punctuation\">@staticmethod</span>\n    <span class=\"token decorator annotation punctuation\">@hook_impl</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">on_pipeline_error</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">,</span> run_params<span class=\"token punctuation\">,</span> pipeline<span class=\"token punctuation\">,</span> catalog<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token string\">\"pops into a debugger on pipeline error\"</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'I hooked into the pipeline during an error'</span><span class=\"token punctuation\">)</span>\n        breakpoint<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n\t<span class=\"token decorator annotation punctuation\">@staticmethod</span>\n    <span class=\"token decorator annotation punctuation\">@hook_impl</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">after_catalog_created</span><span class=\"token punctuation\">(</span>catalog<span class=\"token punctuation\">,</span> conf_catalog<span class=\"token punctuation\">,</span> conf_creds<span class=\"token punctuation\">,</span> feed_dict<span class=\"token punctuation\">,</span> save_version<span class=\"token punctuation\">,</span> load_versions<span class=\"token punctuation\">,</span> run_id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token string\">\"pops into a debugger after catalog created\"</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'I hooked in right after the catalog created'</span><span class=\"token punctuation\">)</span>\n        breakpoint<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n\t<span class=\"token decorator annotation punctuation\">@staticmethod</span>\n    <span class=\"token decorator annotation punctuation\">@hook_impl</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">before_node_run</span><span class=\"token punctuation\">(</span>node<span class=\"token punctuation\">,</span> catalog<span class=\"token punctuation\">,</span> inputs<span class=\"token punctuation\">,</span> is_async<span class=\"token punctuation\">,</span> run_id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token string\">\"pops into a debugger before node run\"</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'I hooked in right before the node run'</span><span class=\"token punctuation\">)</span>\n        breakpoint<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n\t<span class=\"token decorator annotation punctuation\">@staticmethod</span>\n    <span class=\"token decorator annotation punctuation\">@hook_impl</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">after_node_run</span><span class=\"token punctuation\">(</span>node<span class=\"token punctuation\">,</span> catalog<span class=\"token punctuation\">,</span> inputs<span class=\"token punctuation\">,</span> outputs<span class=\"token punctuation\">,</span> is_async<span class=\"token punctuation\">,</span> run_id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token string\">\"pops into a debugger after node run\"</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'I hooked in right after the node run'</span><span class=\"token punctuation\">)</span>\n        breakpoint<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n\t<span class=\"token decorator annotation punctuation\">@staticmethod</span>\n    <span class=\"token decorator annotation punctuation\">@hook_impl</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">on_node_error</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">,</span> node<span class=\"token punctuation\">,</span> catalog<span class=\"token punctuation\">,</span> inputs<span class=\"token punctuation\">,</span> is_async<span class=\"token punctuation\">,</span> run_id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token string\">\"pops into a debugger on node error\"</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'I hooked into the node during an error'</span><span class=\"token punctuation\">)</span>\n        breakpoint<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h4>Implement the hook object</h4>\n<p>With this version of the hook it gets added to the <code class=\"language-text\">ProjectContext</code> as the class itself, not an instance.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">ProjectContext</span><span class=\"token punctuation\">(</span>KedroContext<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token triple-quoted-string string\">\"\"\"Users can override the remaining methods from the parent class here,\n    or create new ones (e.g. as required by plugins)\n    \"\"\"</span>\n\n    project_name <span class=\"token operator\">=</span> <span class=\"token string\">\"kedro_class_hooks\"</span>\n    <span class=\"token comment\"># `project_version` is the version of kedro used to generate the project</span>\n    project_version <span class=\"token operator\">=</span> <span class=\"token string\">\"0.16.1\"</span>\n    package_name <span class=\"token operator\">=</span> <span class=\"token string\">\"kedro_class_hooks\"</span>\n\n    hooks <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n        debug_hook\n    <span class=\"token punctuation\">]</span></code></pre></div>\n<h2>Generalizing debug_hook</h2>\n<p>If we want to generalize the debug hook and make it a bit more re-usable across all of our projects, we can include the <code class=\"language-text\">self</code> argument, on each method and a <code class=\"language-text\">__init__</code> method in which we can configure our hook.  This will make the hook configurable.  We can now create an instance of the <code class=\"language-text\">debug_hook</code> class, and tell it which lifecycle points should trigger the debugger.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token triple-quoted-string string\">\"\"\" Kedro Debug Hook module \"\"\"</span>\n<span class=\"token keyword\">from</span> kedro<span class=\"token punctuation\">.</span>framework<span class=\"token punctuation\">.</span>hooks <span class=\"token keyword\">import</span> hook_impl\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">debug_hook</span><span class=\"token punctuation\">:</span>\n    <span class=\"token triple-quoted-string string\">\"\"\" Kedro Debug Hook\n\n    Opens a debugger at any hook-able point of your kedro projects lifecycle.\n    debug_hook is applied by adding it to the pipeline and setting the desired\n    debug points to true.\n\n    Examples:\n\n        >>> hooks = [debug_hook(should_debug_all=True)]\n        >>> hooks = [debug_hook(should_debug_before_pipeline_run=True)]\n\n    Args:\n        should_debug_all (bool): overrides all points Defaults to False\n        should_debug_before_pipeline_run (bool): opens a debugger\n            before_pipeline_run if True Defaults to False\n        should_debug_after_pipeline_run (bool): opens a debugger\n            after_pipeline_run if True Defaults to False\n        should_debug_on_pipeline_error (bool): opens a debugger\n            on_pipeline_error if True Defaults to False\n        should_debug_before_node_run (bool): opens a debugger\n            before_node_run if True Defaults to False\n        should_debug_after_node_run (bool): opens a debugger\n            after_node_run if True Defaults to False\n        should_debug_on_node_error (bool): opens a debugger\n            on_node_error if True Defaults to False\n        should_debug_after_catalog_created (bool): opens a debugger\n            after_catalog_created if True Defaults to False\n\n    \"\"\"</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>\n        self<span class=\"token punctuation\">,</span>\n        should_debug_all<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">,</span>\n        should_debug_before_pipeline_run<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">,</span>\n        should_debug_after_pipeline_run<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">,</span>\n        should_debug_on_pipeline_error<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">,</span>\n        should_debug_before_node_run<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">,</span>\n        should_debug_after_node_run<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">,</span>\n        should_debug_on_node_error<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">,</span>\n        should_debug_after_catalog_created<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        self<span class=\"token punctuation\">.</span>should_debug_before_pipeline_run <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>\n            should_debug_before_pipeline_run <span class=\"token keyword\">or</span> should_debug_all\n        <span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>should_debug_after_pipeline_run <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>\n            should_debug_after_pipeline_run <span class=\"token keyword\">or</span> should_debug_all\n        <span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>should_debug_on_pipeline_error <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>\n            should_debug_on_pipeline_error <span class=\"token keyword\">or</span> should_debug_all\n        <span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>should_debug_before_node_run <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>\n            should_debug_before_node_run <span class=\"token keyword\">or</span> should_debug_all\n        <span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>should_debug_after_node_run <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>\n            should_debug_after_node_run <span class=\"token keyword\">or</span> should_debug_all\n        <span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>should_debug_on_node_error <span class=\"token operator\">=</span> should_debug_on_node_error <span class=\"token keyword\">or</span> should_debug_all\n        self<span class=\"token punctuation\">.</span>should_debug_after_catalog_created <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>\n            should_debug_after_catalog_created <span class=\"token keyword\">or</span> should_debug_all\n        <span class=\"token punctuation\">)</span>\n\n    <span class=\"token decorator annotation punctuation\">@hook_impl</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">before_pipeline_run</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> run_params<span class=\"token punctuation\">,</span> pipeline<span class=\"token punctuation\">,</span> catalog<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token string\">\"pops into a debugger before pipeline run\"</span>\n        <span class=\"token keyword\">if</span> self<span class=\"token punctuation\">.</span>should_debug_before_pipeline_run<span class=\"token punctuation\">:</span>\n            breakpoint<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token decorator annotation punctuation\">@hook_impl</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">after_pipeline_run</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> run_params<span class=\"token punctuation\">,</span> pipeline<span class=\"token punctuation\">,</span> catalog<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token string\">\"pops into a debugger after pipeline run\"</span>\n        <span class=\"token keyword\">if</span> self<span class=\"token punctuation\">.</span>should_debug_after_pipeline_run<span class=\"token punctuation\">:</span>\n            breakpoint<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token decorator annotation punctuation\">@hook_impl</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">on_pipeline_error</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> error<span class=\"token punctuation\">,</span> run_params<span class=\"token punctuation\">,</span> pipeline<span class=\"token punctuation\">,</span> catalog<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token string\">\"pops into a debugger on pipeline error\"</span>\n        <span class=\"token keyword\">if</span> self<span class=\"token punctuation\">.</span>should_debug_on_pipeline_error<span class=\"token punctuation\">:</span>\n            breakpoint<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token decorator annotation punctuation\">@hook_impl</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">after_catalog_created</span><span class=\"token punctuation\">(</span>\n        self<span class=\"token punctuation\">,</span>\n        catalog<span class=\"token punctuation\">,</span>\n        conf_catalog<span class=\"token punctuation\">,</span>\n        conf_creds<span class=\"token punctuation\">,</span>\n        feed_dict<span class=\"token punctuation\">,</span>\n        save_version<span class=\"token punctuation\">,</span>\n        load_versions<span class=\"token punctuation\">,</span>\n        run_id<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token string\">\"pops into a debugger after catalog created\"</span>\n        <span class=\"token keyword\">if</span> self<span class=\"token punctuation\">.</span>should_debug_after_catalog_created<span class=\"token punctuation\">:</span>\n            breakpoint<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token decorator annotation punctuation\">@hook_impl</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">before_node_run</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> node<span class=\"token punctuation\">,</span> catalog<span class=\"token punctuation\">,</span> inputs<span class=\"token punctuation\">,</span> is_async<span class=\"token punctuation\">,</span> run_id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token string\">\"pops into a debugger before node run\"</span>\n        <span class=\"token keyword\">if</span> self<span class=\"token punctuation\">.</span>should_debug_before_node_run<span class=\"token punctuation\">:</span>\n            breakpoint<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token decorator annotation punctuation\">@hook_impl</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">after_node_run</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> node<span class=\"token punctuation\">,</span> catalog<span class=\"token punctuation\">,</span> inputs<span class=\"token punctuation\">,</span> outputs<span class=\"token punctuation\">,</span> is_async<span class=\"token punctuation\">,</span> run_id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token string\">\"pops into a debugger after node run\"</span>\n        <span class=\"token keyword\">if</span> self<span class=\"token punctuation\">.</span>should_debug_after_node_run<span class=\"token punctuation\">:</span>\n            breakpoint<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token decorator annotation punctuation\">@hook_impl</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">on_node_error</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> error<span class=\"token punctuation\">,</span> node<span class=\"token punctuation\">,</span> catalog<span class=\"token punctuation\">,</span> inputs<span class=\"token punctuation\">,</span> is_async<span class=\"token punctuation\">,</span> run_id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token string\">\"pops into a debugger on node error\"</span>\n        <span class=\"token keyword\">if</span> self<span class=\"token punctuation\">.</span>should_debug_on_node_error<span class=\"token punctuation\">:</span>\n            breakpoint<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h4>implement the hook instance</h4>\n<p>When <code class=\"language-text\">self</code> is used in the method calls we must pass an instance of the <code class=\"language-text\">debug_hook</code> into the hooks list, not the class itself.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">ProjectContext</span><span class=\"token punctuation\">(</span>KedroContext<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token triple-quoted-string string\">\"\"\"Users can override the remaining methods from the parent class here,\n    or create new ones (e.g. as required by plugins)\n    \"\"\"</span>\n\n    project_name <span class=\"token operator\">=</span> <span class=\"token string\">\"kedro_class_hooks\"</span>\n    <span class=\"token comment\"># `project_version` is the version of kedro used to generate the project</span>\n    project_version <span class=\"token operator\">=</span> <span class=\"token string\">\"0.16.1\"</span>\n    package_name <span class=\"token operator\">=</span> <span class=\"token string\">\"kedro_class_hooks\"</span>\n\n    hooks <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>debug_hook<span class=\"token punctuation\">(</span>should_debug_all<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span></code></pre></div>\n<h2>Final thoughts</h2>\n<p>Hooks are an amazing addition to the kedro framework that will allow the community to make big changes to how their kedro project gets ran without needing to change kedro itself.  Using a hook class with self can make them so much more configurable, and reusable across different projects without a lot of extra code. Personally I still really like the module method that we used in <a href=\"https://waylonwalker.com/creating-the-kedro-preflight-hook/\">kedro-preflight</a>.</p>","fields":{"slug":"/kedro-class-hooks/"},"frontmatter":{"tags":[],"title":"Create Configurable Kedro Hooks","description":"There are two main ways to create kedro hooks, with modules and classes.  Each one still uses the same verbiage as the function/method names.  Class hooks seem a bit special as they give you a way to configure them so that they are a bit more generally useful.","templateKey":"blog-post","status":"published","date":"2020-05-23T05:00:00.000Z","cover":null}},"similarPosts":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]}},"staticQueryHashes":["2992646504"]}