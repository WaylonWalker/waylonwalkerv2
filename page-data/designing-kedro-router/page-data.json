{"componentChunkName":"component---src-templates-blog-post-js","path":"/designing-kedro-router/","result":{"data":{"markdownRemark":{"id":"2b855263-47cf-5287-847c-4148dcacd476","html":"<h2>nodes_global</h2>\n<p>I released a router-like plugin for kedro back in April 2020.  This was not the first design, the idea actually came from one of the QB folks who taught me kedro nearly a year before.  We were assembling our pipelines with something called <code class=\"language-text\">nodes_global</code>.  It worked fairly well but did have some issues around being set as a global variable.</p>\n<p><em>But...</em></p>\n<p>One thing in particular that it did not lend itself well to was being able to create a packagable pipeline that I could pip install and append into any of my existing pipelines.  Something I am still trying to work out, maybe I don't need this.  I think I have it working for our internal pipelines and it seems like the way to go, but we don't necessarily end up using it.</p>\n<p><em>Also...</em></p>\n<p>With this pattern all of the nodes needed to be importable by the module containing nodes_global.  I find that this becomes a big hurdle for new pipelines coming from jupyter to overcome and can be most infuriating when their nodes aren't getting ran after they added them.</p>\n<p style=\"text-align: center\" align=\"center\">\n<a href=\"https://waylonwalker.com/what-is-kedro\">\n  <img style=\"width:400px; max-width:80%; margin: auto;\" src=\"https://waylonwalker.com/what-is-kedro.png\" alt=\"What is kedro\" width=\"400\">\n  </a>\n</p>\n<blockquote>\n<p>If you are a bit unsure about what kedro is make sure to check out my <a href=\"https://waylonwalker.com/what-is-kedro\">what-is-kedro</a> article.</p>\n</blockquote>\n<h2>@node(inputs='a<em>raw</em>cars', outputs='b<em>int</em>cars')</h2>\n<p>I set off to design something that was flask-like.  Around November I had something working.  You could simply start creating functions. and decorate these functions with a decorator just like with flask.  I even had it setup to autoname the nodes things like <code class=\"language-text\">create_b_int_cars</code>.</p>\n<p><em>But....</em></p>\n<p>This did not lend well to pulling in functions from a library or dynamically creating nodes.  I didn't realize how few nodes I actually make in my pipelines that are a 1:1 relationship between the node and function in real work.  Most examples work this way, but for some reason when I step into a project we end up pulling a lot of functions out of existing libraries, or dynamically creating many datasets from a list of options.</p>\n<h2>pytest inspired</h2>\n<p><em>simplicity</em></p>\n<p>The final design ended up being suggested by a colleague of mine who is not using kedro, but is a  brilliant python dev.  The idea was to walk through the project like pytest does looking for modules and variables with a certain pattern (<code class=\"language-text\">node</code>, or <code class=\"language-text\">pipeline</code>).</p>\n<p>I have been using this since April and am loving it. It has have very little change since first release.  When I create a new module, that automatically becomes a new pipeline in my <code class=\"language-text\">pipelines</code> dict and all of the variables with the name node get scrapped up and put into a single pipeline.</p>\n<p><em>Beginner Friendly</em></p>\n<p>Just like with pytest.  You just start hacking in modules ending with <code class=\"language-text\">_nodes.py</code> with nodes in them and they just appear in your final pipeline.</p>\n<h2>How to use it</h2>\n<p>The <a href=\"https://github.com/WaylonWalker/find-kedro\">readme</a> has some great examples.</p>\n<h2>Install it</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">pip install find<span class=\"token operator\">-</span>kedro</code></pre></div>\n<h2>Enable it</h2>\n<p>Enable it by changing one line in your run.py</p>\n<p><em><small><mark>run.py</mark></small></em></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> kedro<span class=\"token punctuation\">.</span>context <span class=\"token keyword\">import</span> KedroContext\n<span class=\"token keyword\">from</span> find_kedro <span class=\"token keyword\">import</span> find_kedro\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">ProjectContext</span><span class=\"token punctuation\">(</span>KedroContext<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">_get_pipelines</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> Pipeline<span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">return</span> find_kedro<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Or if your using the new <code class=\"language-text\">hooks.py</code> method.  Again no need to import all of your nodes.</p>\n<p><em><small><mark>hooks.py</mark></small></em></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">ProjectHooks</span><span class=\"token punctuation\">:</span>\n    <span class=\"token decorator annotation punctuation\">@hook_impl</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">register_pipelines</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> Dict<span class=\"token punctuation\">[</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">,</span> Pipeline<span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span>\n        <span class=\"token triple-quoted-string string\">\"\"\"Register the project's pipeline.\n        Returns:\n            A mapping from a pipeline name to a ``Pipeline`` object.\n        \"\"\"</span>\n\n        <span class=\"token keyword\">return</span> find_kedro<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h2>Use it</h2>\n<p>Check out the <a href=\"https://github.com/WaylonWalker/find-kedro\">readme</a> for more examples, but this one is the one that I use and recommend most often.  This method helps keep nodes close to functions that are designed for them.</p>\n<p><em><small><mark>my</em>nodes.py</mark></small>_</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># my-proj/pipelinies/data_engineering/pipeline</span>\n<span class=\"token keyword\">from</span> kedro<span class=\"token punctuation\">.</span>pipeline <span class=\"token keyword\">import</span> node\n<span class=\"token keyword\">from</span> <span class=\"token punctuation\">.</span>nodes <span class=\"token keyword\">import</span> split_data\n\nnodes <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">split_data</span><span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">:</span> pd<span class=\"token punctuation\">.</span>DataFrame<span class=\"token punctuation\">,</span> ratio<span class=\"token punctuation\">:</span> <span class=\"token builtin\">float</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> Dict<span class=\"token punctuation\">[</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">,</span> pd<span class=\"token punctuation\">.</span>DataFrame<span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span>\n   <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n\nnodes<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>\n    node<span class=\"token punctuation\">(</span>\n        split_data<span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">[</span><span class=\"token string\">\"example_iris_data\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"params:example_test_data_ratio\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n        <span class=\"token builtin\">dict</span><span class=\"token punctuation\">(</span>\n            train_x<span class=\"token operator\">=</span><span class=\"token string\">\"example_train_x\"</span><span class=\"token punctuation\">,</span>\n            train_y<span class=\"token operator\">=</span><span class=\"token string\">\"example_train_y\"</span><span class=\"token punctuation\">,</span>\n            test_x<span class=\"token operator\">=</span><span class=\"token string\">\"example_test_x\"</span><span class=\"token punctuation\">,</span>\n            test_y<span class=\"token operator\">=</span><span class=\"token string\">\"example_test_y\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<h1>Want a simple guide to get started with find kedro</h1>\n<p style='text-align: center' align='center'>\n<a href='https://find.kedro.dev/examples/iris/>\n  <img\n    style='width:400px; max-width:80%; border-radius: '35px'; margin: auto;'\n    width='400'\n    src=\"https://waylonwalker.com/find-kedro-examples-iris.png\"\n    alt=\"Find Kedro Iris example\"\n  />\n  </a>\n</p>\n<p>In <a href=\"https://find.kedro.dev/examples/iris/\">this doc</a> I transform the kedro iris template to find-kedro.</p>\n<h1>Ready to start using kedro</h1>\n<p>If you still have not tried out kedro, it's easier than you think. Check out <a href=\"https://waylonwalker.com/create-new-kedro-project\">create-new-kedro-project</a> to get a project started in just a few minutes.</p>\n<p style=\"text-align: center\" align=\"center\">\n<a href=\"https://waylonwalker.com/create-new-kedro-project\">\n  <img style=\"width:400px; max-width:80%; margin: auto;\" width=\"400\" src=\"https://waylonwalker.com/create-new-kedro-project.png\" alt=\"Create New Kedro Project\">\n  </a>\n</p>","fields":{"slug":"/designing-kedro-router/"},"frontmatter":{"date":"2020-10-08T05:00:00.000Z","title":"Designing a \"Router\" for kedro","description":"I released a router-like plugin for kedro back in April 2020. This was not the first design, the idea actually came from one of the QB folks who taught me kedro nearly a year before.","status":"published","cover":{"absolutePath":"/home/runner/work/waylonwalkerv2/waylonwalkerv2/static/designing-kedro-router-xmas2020.png","xsm_img":{"fixed":{"src":"/static/4d3533531643ce0398a66dbf2ad3b2a8/ef958/designing-kedro-router-xmas2020.png","srcWebp":"/static/4d3533531643ce0398a66dbf2ad3b2a8/f6b6d/designing-kedro-router-xmas2020.webp"}},"sm_img":{"fixed":{"src":"/static/4d3533531643ce0398a66dbf2ad3b2a8/630fb/designing-kedro-router-xmas2020.png","srcWebp":"/static/4d3533531643ce0398a66dbf2ad3b2a8/403a4/designing-kedro-router-xmas2020.webp"}},"med_img":{"fixed":{"src":"/static/4d3533531643ce0398a66dbf2ad3b2a8/46604/designing-kedro-router-xmas2020.png","srcWebp":"/static/4d3533531643ce0398a66dbf2ad3b2a8/e9589/designing-kedro-router-xmas2020.webp"}},"full":{"fixed":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAABvklEQVQY0y3RPW/TUBQG4Cydq4Y0JG4+Gt848ec959q5ru3ENknakgAhSqUSqIqKQIxBMLWICRXaDpGqLq3oABIMsDIgISGxMCC2Dqwd+CdcR5Vene3Re3ROqlhlZQWXanZBBt1u8mDNjfsabWVlKslM1XyAG4htpCFik9qhAz7YAWMespVUocpEpCrLV6jJo6g73Lw/HgzaXosiZ7LK60Zz5kVCykIEn7IAmAfMTSVMhKCY1yuUWOFqL54ePJgebG1v9UvLbrnOdSMkiqtqnmkFJgQW+CauUJxhiaCI8NJshcUynH/48vHzV91ejTsbmh29eXs82tjp9e81eMewPAt9C70ZJphV7Axhkow5GQs1Z26+eP7+0/cfP1+9Pvr1+8/05Ozy8t/xybuLi7/PX7ysEAC7eYXTMlpF3ZXNRcLyMoj+ayUjujkajh89fPpsOH5yZ/Px7t5+FN+dTPbW1kea4VIMrvCyit+O9g93JvMlUyKQSzxkSmZ6qZbO5rFzCzy+kNNNK1JqXDO8RIqDMz/BFOB0d/u2P1goGqJW4MSLFyiQKdR7g3YY80wZKyp3WNt3urGzHja6LadD6o3/yuBwhbqd3W0AAAAASUVORK5CYII=","width":1000,"height":420,"src":"/static/4d3533531643ce0398a66dbf2ad3b2a8/a8734/designing-kedro-router-xmas2020.png","srcSet":"/static/4d3533531643ce0398a66dbf2ad3b2a8/a8734/designing-kedro-router-xmas2020.png 1x"},"fluid":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAABvklEQVQY0y3RPW/TUBQG4Cydq4Y0JG4+Gt848ec959q5ru3ENknakgAhSqUSqIqKQIxBMLWICRXaDpGqLq3oABIMsDIgISGxMCC2Dqwd+CdcR5Vene3Re3ROqlhlZQWXanZBBt1u8mDNjfsabWVlKslM1XyAG4htpCFik9qhAz7YAWMespVUocpEpCrLV6jJo6g73Lw/HgzaXosiZ7LK60Zz5kVCykIEn7IAmAfMTSVMhKCY1yuUWOFqL54ePJgebG1v9UvLbrnOdSMkiqtqnmkFJgQW+CauUJxhiaCI8NJshcUynH/48vHzV91ejTsbmh29eXs82tjp9e81eMewPAt9C70ZJphV7Axhkow5GQs1Z26+eP7+0/cfP1+9Pvr1+8/05Ozy8t/xybuLi7/PX7ysEAC7eYXTMlpF3ZXNRcLyMoj+ayUjujkajh89fPpsOH5yZ/Px7t5+FN+dTPbW1kea4VIMrvCyit+O9g93JvMlUyKQSzxkSmZ6qZbO5rFzCzy+kNNNK1JqXDO8RIqDMz/BFOB0d/u2P1goGqJW4MSLFyiQKdR7g3YY80wZKyp3WNt3urGzHja6LadD6o3/yuBwhbqd3W0AAAAASUVORK5CYII=","aspectRatio":2.380952380952381,"src":"/static/4d3533531643ce0398a66dbf2ad3b2a8/a8734/designing-kedro-router-xmas2020.png","srcSet":"/static/4d3533531643ce0398a66dbf2ad3b2a8/2d6f8/designing-kedro-router-xmas2020.png 250w,\n/static/4d3533531643ce0398a66dbf2ad3b2a8/03ac3/designing-kedro-router-xmas2020.png 500w,\n/static/4d3533531643ce0398a66dbf2ad3b2a8/a8734/designing-kedro-router-xmas2020.png 1000w","sizes":"(max-width: 1000px) 100vw, 1000px"}}}}}},"pageContext":{"id":"2b855263-47cf-5287-847c-4148dcacd476","prev":{"id":"c27f38ac-a9f3-5f47-970f-da83bd821d6d","html":"<h2>Using pdb</h2>","fields":{"slug":"/debugging-python/"},"frontmatter":{"tags":[],"title":"Debugging Python","description":"Debugging Python","templateKey":"blog-post","status":"published","date":"2019-10-01T05:00:00.000Z","cover":{"med_img":{"fixed":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAIBAwX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAABznoakID/xAAbEAACAgMBAAAAAAAAAAAAAAAAAQIhAxESMv/aAAgBAQABBQLHByJqzqn52f/EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABkQAAIDAQAAAAAAAAAAAAAAAAABEDFRYf/aAAgBAQAGPwI5CE9KP//EABsQAAMBAAMBAAAAAAAAAAAAAAABESExUWGB/9oACAEBAAE/IdBLF6Ti/Cg4PhKGTI6H/9oADAMBAAIAAwAAABBk/wD/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAbEAEBAQEBAAMAAAAAAAAAAAABEQAhMUFRYf/aAAgBAQABPxBVA+nGsTsEgHns0GTOtbIz5mJGrVv5gjqL363/2Q==","width":500,"height":333,"src":"/static/f3550b22c25b9c2568600c17f964c578/0f3a1/jayden-yoon-19DxK0IG-hQ-unsplash.jpg","srcSet":"/static/f3550b22c25b9c2568600c17f964c578/0f3a1/jayden-yoon-19DxK0IG-hQ-unsplash.jpg 1x,\n/static/f3550b22c25b9c2568600c17f964c578/f9913/jayden-yoon-19DxK0IG-hQ-unsplash.jpg 1.5x,\n/static/f3550b22c25b9c2568600c17f964c578/a7715/jayden-yoon-19DxK0IG-hQ-unsplash.jpg 2x"}},"childImageSharp":{"fixed":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAJABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAEDAgX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAAB57yqmWD/xAAaEAACAgMAAAAAAAAAAAAAAAAAAgEREjFC/9oACAEBAAEFAkiB8bH1yp//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAYEAADAQEAAAAAAAAAAAAAAAABEBEAAv/aAAgBAQAGPwK9GaoP/8QAGxAAAgIDAQAAAAAAAAAAAAAAAAEhMUFxkaH/2gAIAQEAAT8h5wixoFMbmjwGBR7P/9oADAMBAAIAAwAAABDE3//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABYRAQEBAAAAAAAAAAAAAAAAAAARYf/aAAgBAgEBPxDVf//EABwQAQACAgMBAAAAAAAAAAAAAAEAESGhUXGx0f/aAAgBAQABPxAwpxsOA7j6tgUZUxyxBApqPY7vk2E//9k=","width":200,"height":85,"src":"/static/f3550b22c25b9c2568600c17f964c578/a6613/jayden-yoon-19DxK0IG-hQ-unsplash.jpg","srcSet":"/static/f3550b22c25b9c2568600c17f964c578/a6613/jayden-yoon-19DxK0IG-hQ-unsplash.jpg 1x,\n/static/f3550b22c25b9c2568600c17f964c578/b97e6/jayden-yoon-19DxK0IG-hQ-unsplash.jpg 1.5x,\n/static/f3550b22c25b9c2568600c17f964c578/eeb4b/jayden-yoon-19DxK0IG-hQ-unsplash.jpg 2x"}}}}},"next":{"id":"5149ae93-ff8a-52f3-82de-43fbf6123490","html":"<p>I want to incorporate some of the wonderful comments, ðŸ’•, ðŸ¦„, and ðŸ”–'s that I have been getting on <strong>dev.to</strong> on my website.  I have dabbled once or twice with no avail this time I am taking notes on my journey, so follow along and let's get there together.  By the end of this post, I will have a way to get comments from posts on the client-side thanks to the wonderfully open dev.to API.</p>\n<h2>The API</h2>\n<p>dev.to has an open API that allows us to easily get comments as HTML.  They have their API hosted at <a href=\"https://docs.dev.to/api/#tag/comments\">https://docs.dev.to/api/#tag/comments</a>, let's take a look at it.</p>\n<p><img src=\"https://waylonwalker.com/dev-to-api-comments.png\"></p>\n<p>Here we can see that going to <a href=\"https://dev.to/api/comments?a_id=270180\">https://dev.to/api/comments?a_id=270180</a> returns us some json, that contains an array of comments.</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">[</span>\n  <span class=\"token punctuation\">{</span>body_html<span class=\"token operator\">:</span> '&lt;the comment rendered as html>'<span class=\"token punctuation\">,</span>\n   user<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>&lt;an array with quite a bit of information about the commenting user><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n   children<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>&lt;an array of child comment objects><span class=\"token punctuation\">]</span>\n   &lt;other stuff we don't care about>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  &lt;more comments>\n  <span class=\"token punctuation\">]</span></code></pre></div>\n<h2>What the heck is that a_id</h2>\n<p>That is an <code class=\"language-text\">article_id</code>.  Though a bit of searching I found that it occurs in at least four places on every page as a data attribute.  Using chrome dev tools I found a good place to \"query\" it from.</p>\n<p><img src=\"https://waylonwalker.com/dev-to-article-id.png\"></p>\n<p>With this knowledge, we can fetch the contents of an article and pull the <code class=\"language-text\">articleId</code> from it.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">    <span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">getDevToAId</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">url</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// Gets the articleId of a dev.to article</span>\n        <span class=\"token keyword\">const</span> root <span class=\"token operator\">=</span> <span class=\"token string\">'https://dev.to/'</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>url<span class=\"token punctuation\">.</span><span class=\"token function\">includes</span><span class=\"token punctuation\">(</span>root<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            url <span class=\"token operator\">=</span> root <span class=\"token operator\">+</span> url\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">let</span> domparser <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">DOMParser</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">const</span> html <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">r</span> <span class=\"token operator\">=></span> r<span class=\"token punctuation\">.</span><span class=\"token function\">text</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">const</span> doc <span class=\"token operator\">=</span> domparser<span class=\"token punctuation\">.</span><span class=\"token function\">parseFromString</span><span class=\"token punctuation\">(</span>html<span class=\"token punctuation\">,</span> <span class=\"token string\">'text/html'</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">const</span> articleId <span class=\"token operator\">=</span> doc<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#article-body'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>dataset<span class=\"token punctuation\">.</span>articleId\n        <span class=\"token keyword\">return</span> articleId\n    <span class=\"token punctuation\">}</span></code></pre></div>\n<p><strong>note</strong>  I do check to see if a full URL or slug was given, if it was just the slug I tack on <code class=\"language-text\">https://dev.to/</code> before fetching.</p>\n<h2>Now the comments</h2>\n<p>The main event is here, what you all have waited for, and it's by far the easiest part.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">    <span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">getDevToComments</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">url</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">const</span> articleId <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">getDevToAId</span><span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">const</span> response <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">https://dev.to/api/comments?a_id=</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>articleId<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">const</span> comments <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> response<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">return</span> comments\n    <span class=\"token punctuation\">}</span></code></pre></div>\n<p>The hardest part of this was figuring out what the <code class=\"language-text\">a_id</code> was and how I was going to get it from some more commonly known information about my articles, the URL, or the slug</p>\n<h2>Try it out</h2>\n<p><strong>F12</strong> pop open your console right in dev tools of this post and try it out.</p>\n<p><img src=\"https://waylonwalker.com/dev-to-comments-in-devtools.png\"></p>","fields":{"slug":"/devto-comments-from-url/"},"frontmatter":{"tags":[],"title":"How to get Dev Comments from an article Url","description":"I want to incorporate some of the wonderful comments, ðŸ’•, ðŸ¦„, and ðŸ”–'s that I have been getting on dev.to on my website.  I have dabbled once or twice with no avail this time I am taking notes on my journey, so follow along and let's get there together.  By the end of this post, I will have a way to get comments from posts on the client-side thanks to the wonderfully open dev.to API.","templateKey":"blog-post","status":"published","date":"2020-05-20T10:00:00.000Z","cover":null}},"similarPosts":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]}},"staticQueryHashes":["2992646504"]}