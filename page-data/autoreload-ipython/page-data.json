{"componentChunkName":"component---src-templates-blog-post-js","path":"/autoreload-ipython/","result":{"data":{"markdownRemark":{"id":"ec3083c5-7ebe-5adc-bcc3-ea419b4ca11f","html":"<h1>Autoreload in Ipython</h1>\n<p>I have used <code class=\"language-text\">%autoreload</code> for several years now with great success and üî• rapid reloads.  It allows me to move super fast when developing libraries and modules.  They have made some great updates this year that allows class modules to be automatically be updated.</p>\n<h2>What I like about autoreload</h2>\n<p>üî• Blazing Fast</p>\n<p>üí• Keeps me in the comfort of my text editor</p>\n<p>üëè Allows me to use Jupyter when I need</p>\n<p>üëü Extremely Reliable</p>\n<p>One of the biggest benefits that I find is that it shortens the distance between my module/library code and test code inside of a terminal/notebook.  Now I primarily use jupyter notebooks for the presentation aspect.  I develop code from the comfort of my editor with all of the tools I have setup, and run the functions in a notebook to get the output.  From there I might do some aggregations or plots, but the ü•© meat of development is done outside of jupyter.</p>\n<blockquote>\n<p>Now I primarily use jupyter notebooks for the presentation aspect.</p>\n</blockquote>\n<h2>Enabling Autoreload</h2>\n<p>üìê <em>config</em></p>\n<p>This is a short script that I use to setup ipython so that it automatically reloads modules.  This allows me to use a separate terminal and editor, and keep data in memory while developing functions.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">ipython profile create</code></pre></div>\n<p>Then edit the created file <code class=\"language-text\">~/.ipython/profile_default/ipython_config.py</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">c<span class=\"token punctuation\">.</span>InteractiveShellApp<span class=\"token punctuation\">.</span>extensions <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'autoreload'</span><span class=\"token punctuation\">]</span>\nc<span class=\"token punctuation\">.</span>InteractiveShellApp<span class=\"token punctuation\">.</span>exec_lines <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'%autoreload 2'</span><span class=\"token punctuation\">]</span>\nc<span class=\"token punctuation\">.</span>InteractiveShellApp<span class=\"token punctuation\">.</span>exec_lines<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token string\">'print(\"Warning: disable autoreload in ipython_config.py to improve performance.\")'</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h2>According to the docs</h2>\n<p><a href=\"https://ipython.org/ipython-doc/3/config/extensions/autoreload.html#caveats\" title=\"IPython caveats\">autoreload caveates</a></p>\n<blockquote>\n<p>Some of the known remaining caveats are:</p>\n<p>Replacing code objects does not always succeed: changing a @property in a class to an ordinary method or a method to a member variable can cause problems (but in old objects only).\nFunctions that are removed (eg. via monkey-patching) from a module before it is reloaded are not upgraded.\nC extension modules cannot be reloaded, and so cannot be autoreloaded.</p>\n</blockquote>\n<h2>So what can gets updated??</h2>\n<p>ü§≤ <em>Nearly everything...</em></p>\n<ul>\n<li>new/updated functions</li>\n<li>new/updated functions</li>\n<li>new/updated class methods</li>\n<li>new/updated class attributes</li>\n</ul>\n<h2>What does not get updated</h2>\n<p>üîÑ <em>needs restart</em></p>\n<p><strong>config</strong> files that are side loaded with modules typically do not get updated in my experience, and I tend to restart the session.</p>\n<p><strong>init</strong> class methods do not get reran, but the session does not need to be reloaded.  The class instance will just need to be re-instanciated.</p>\n<h2>Testing out the capabilities</h2>\n<p>üí® <em>Watch</em> it go</p>\n<p>Here is a gif of me taking autoreload out for a test drive.  When creating the session test_autoreload.py does not even exist. From there new functions, classes, attributes, and methods are added in the file and all live reload into ipython.</p>\n<p><img src=\"../../test_autoreload4.gif\">\n<em>for more gifs like these follow me on twitter</em> <a href=\"https://twitter.com/_WaylonWalker\"><em>@waylonwalker</em></a></p>\n<h2>What About Jupyter Notebooks????</h2>\n<p>üí• <em>Exactly the Same</em></p>\n<p>Since jupyter uses ipython in be background Jupyter will use the same <code class=\"language-text\">ipython_config.py</code> file to have autoreload enabled by default.</p>\n<p><img src=\"../../test_autoreload_jupyter.gif\">\n<em>for more gifs like these follow me on twitter</em> <a href=\"https://twitter.com/_WaylonWalker\"><em>@waylonwalker</em></a></p>\n<h2>Go use it now</h2>\n<p>Take the splash into rapid development of python functions with minimal distance between your modules/library and your ipython/jupyter session.</p>","fields":{"slug":"/autoreload-ipython/"},"frontmatter":{"date":"2019-09-08T05:00:00.000Z","title":"Autoreload in Ipython","description":"Autoreload in python","status":"published","cover":{"absolutePath":"/home/runner/work/waylonwalkerv2/waylonwalkerv2/static/autoreload-ipython-xmas2020.png","xsm_img":{"fixed":{"src":"/static/de227ffcb7da2e5c1170a8434163bec9/ef958/autoreload-ipython-xmas2020.png","srcWebp":"/static/de227ffcb7da2e5c1170a8434163bec9/f6b6d/autoreload-ipython-xmas2020.webp"}},"sm_img":{"fixed":{"src":"/static/de227ffcb7da2e5c1170a8434163bec9/630fb/autoreload-ipython-xmas2020.png","srcWebp":"/static/de227ffcb7da2e5c1170a8434163bec9/403a4/autoreload-ipython-xmas2020.webp"}},"med_img":{"fixed":{"src":"/static/de227ffcb7da2e5c1170a8434163bec9/46604/autoreload-ipython-xmas2020.png","srcWebp":"/static/de227ffcb7da2e5c1170a8434163bec9/e9589/autoreload-ipython-xmas2020.webp"}},"full":{"fixed":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAABmElEQVQY013PzW7TQBDA8TwBpSEtsVPX7q7tON6PmXXirNexA2lJKqBBBNQWmkjlSwhUIaSqUjkhIYTgwpWH4M77YecG0lzm8NP8p+H4yg3QDtWur5wQq7VJmE34LRq3KZBoGMsxE6UQI8RCJmUfDCS5Uhkq3djxVTUWVTsUbb/GQag3vd4NL2p6ccdHr6d9ZoQoAQqhCgQjVQ4qAzVs2JWsMVa+RYTsjX/Pf34s3n2ZXL4xrz7vX12NL75Nr18WLwKuAUoOuQDDUUtcY7u6WWO8TcEP9bleLdOzZfr8UD06NWcLfHpRvF1kx5HIZXW8wmgEZmtMcTtIWlTZBC2C20RsuFVzXGfvsTAtmZmwdEIizfhI/IebBIUTDwnfosoi0CbQoYnliS1HtvfQ7Q7uzp4sV+9Pjl/rbMZl/g/2Ivzz4+v38w8bu9ymUMe7jGTz/OixH7JpqtpuHMjR/QfPjDlkdXmNQZkaS4Bf16uHZr7pMGv9/M0Ony2OPl3eo12cDhM3xJYrLA8kL7Pk4E5/Vg4Oiv4+7Q7+ApJFX6of+/B6AAAAAElFTkSuQmCC","width":1000,"height":420,"src":"/static/de227ffcb7da2e5c1170a8434163bec9/a8734/autoreload-ipython-xmas2020.png","srcSet":"/static/de227ffcb7da2e5c1170a8434163bec9/a8734/autoreload-ipython-xmas2020.png 1x"},"fluid":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAABmElEQVQY013PzW7TQBDA8TwBpSEtsVPX7q7tON6PmXXirNexA2lJKqBBBNQWmkjlSwhUIaSqUjkhIYTgwpWH4M77YecG0lzm8NP8p+H4yg3QDtWur5wQq7VJmE34LRq3KZBoGMsxE6UQI8RCJmUfDCS5Uhkq3djxVTUWVTsUbb/GQag3vd4NL2p6ccdHr6d9ZoQoAQqhCgQjVQ4qAzVs2JWsMVa+RYTsjX/Pf34s3n2ZXL4xrz7vX12NL75Nr18WLwKuAUoOuQDDUUtcY7u6WWO8TcEP9bleLdOzZfr8UD06NWcLfHpRvF1kx5HIZXW8wmgEZmtMcTtIWlTZBC2C20RsuFVzXGfvsTAtmZmwdEIizfhI/IebBIUTDwnfosoi0CbQoYnliS1HtvfQ7Q7uzp4sV+9Pjl/rbMZl/g/2Ivzz4+v38w8bu9ymUMe7jGTz/OixH7JpqtpuHMjR/QfPjDlkdXmNQZkaS4Bf16uHZr7pMGv9/M0Ony2OPl3eo12cDhM3xJYrLA8kL7Pk4E5/Vg4Oiv4+7Q7+ApJFX6of+/B6AAAAAElFTkSuQmCC","aspectRatio":2.380952380952381,"src":"/static/de227ffcb7da2e5c1170a8434163bec9/a8734/autoreload-ipython-xmas2020.png","srcSet":"/static/de227ffcb7da2e5c1170a8434163bec9/2d6f8/autoreload-ipython-xmas2020.png 250w,\n/static/de227ffcb7da2e5c1170a8434163bec9/03ac3/autoreload-ipython-xmas2020.png 500w,\n/static/de227ffcb7da2e5c1170a8434163bec9/a8734/autoreload-ipython-xmas2020.png 1000w","sizes":"(max-width: 1000px) 100vw, 1000px"}}}}}},"pageContext":{"id":"ec3083c5-7ebe-5adc-bcc3-ea419b4ca11f","prev":{"id":"c9a7e3bb-d196-562c-8559-9ec8e2eb2a26","html":"<p>One thing we all dread is mundane work of getting started, and all the hoops it\ntakes to get going.  This year I want to post more often and I am taking some\nsteps towards making it easier for myself to just get started.</p>\n<p>When I start a new post I need to cd into my blog directory, start neovim in a\nmarkdown file with a clever name, copy some frontmatter boilerplate, update the\npost date, add tags, a description, and a cover.</p>\n<h2>Todo List for starting a post</h2>\n<ul>\n<li>frontmatter template</li>\n<li>Title</li>\n<li>slug</li>\n<li>tags</li>\n<li>date</li>\n<li>cover</li>\n<li>description</li>\n<li>create markdown file</li>\n<li>open in neovim</li>\n</ul>\n<h2>Lets Automate this</h2>\n<h3>This aint no proper cli</h3>\n<p><em>hot and fast</em></p>\n<p>As with many thing running behind the scenes on this site, I am the one and\nonly user, I have limited time, so this is going to be a bit <strong>hot and fast</strong>.\nLet's create a file called new-post.</p>\n<p><em><small><mark>start the script new-post</mark></small></em></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\">#!python</span>\n<span class=\"token comment\"># new-post</span></code></pre></div>\n<blockquote>\n<p>üëÜ Works on my machine</p>\n</blockquote>\n<p>If this were something that had more users than me I would probably use\nsomething like click, but for this I want to get it done quick and avoid any\nneed to manage dependencies.  Be careful if you were to share something with a\n<code class=\"language-text\">#!python</code> as it requries the end user to have the right version of python\nready to go.</p>\n<h3>Title</h3>\n<p>The title can't really be automated this is the core idea coming out of my üß†,\nbut it will be captured through the cli and put into proper position.  For this\nI'm going super simple and just pulling it out of <code class=\"language-text\">sys.argv</code></p>\n<p><em><small><mark>set the title</mark></small></em></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> sys\n\ntitle <span class=\"token operator\">=</span> sys<span class=\"token punctuation\">.</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<blockquote>\n<p>! sys.argv is a list of each argument passed into the script split by spaces.</p>\n</blockquote>\n<h3>slug</h3>\n<p>The slug is what I am calling the route and can simply come out of the title\nautomatically, if I want to shorten it later by hand that will be simple enough\nto do manually. All that needs to be done is to lowercase and replace a few\ncharacters with -.</p>\n<p><em><small><mark>set the slug</mark></small></em></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">slug <span class=\"token operator\">=</span> title<span class=\"token punctuation\">.</span>lower<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">.</span>replace<span class=\"token punctuation\">(</span><span class=\"token string\">\" \"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"-\"</span><span class=\"token punctuation\">.</span>replace<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token string\">\"_\"</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h3>tags</h3>\n<p>For tags I decided I wanted the parser to be as simple as possible and didnt\nwant to dance around any flags.  I am simply just going to look at every\nargument passed into the command and see if any of them contain one of my\ncommon tags.  </p>\n<p><em><small><mark>parse the tags</mark></small></em></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">args <span class=\"token operator\">=</span> <span class=\"token string\">''</span><span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>sys<span class=\"token punctuation\">.</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\ntags <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n\n<span class=\"token keyword\">if</span> <span class=\"token string\">'py'</span> <span class=\"token keyword\">in</span> args<span class=\"token punctuation\">:</span>\n    tags<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token string\">'python'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">if</span> <span class=\"token string\">'web'</span> <span class=\"token keyword\">in</span> args<span class=\"token punctuation\">:</span>\n    tags<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token string\">'webdev'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">if</span> <span class=\"token string\">'blog'</span> <span class=\"token keyword\">in</span> args<span class=\"token punctuation\">:</span>\n    tags<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token string\">'blog'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">if</span> <span class=\"token string\">'data'</span> <span class=\"token keyword\">in</span> args<span class=\"token punctuation\">:</span>\n    tags<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token string\">'data'</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>ü§∑‚Äç‚ôÇÔ∏è <strong>antipattern</strong>?? The above section does an initialize then modify.  I generally try to avoid this\npattern with something like a list comprehension, but didn't see an obvious\nsolution so I just went with it.</p>\n<h2>Frontmatter Template</h2>\n<p>Now we have enough information going to assemble the frontmatter I use for my\nposts.  I am going to just insert the values I need into an f-string.  Since\npython 3.6 was released f-strings are my go to templating tool.</p>\n<p><em><small><mark>create the markdown</mark></small></em></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> datetime\n\nfrontmatter <span class=\"token operator\">=</span> <span class=\"token string-interpolation\"><span class=\"token string\">f\"\"\"---\ntemplateKey: blog-post\ntags: </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>tags<span class=\"token punctuation\">}</span></span><span class=\"token string\">\ntitle: </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>title<span class=\"token punctuation\">}</span></span><span class=\"token string\">\ndate: </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>datetime<span class=\"token punctuation\">.</span>date<span class=\"token punctuation\">.</span>today<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>strftime<span class=\"token punctuation\">(</span><span class=\"token string\">'%Y-%m-%dT%H:%M:%S'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token string\">\nstatus: draft\ndescription: ''\ncover: \"/static/</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>slug<span class=\"token punctuation\">}</span></span><span class=\"token string\">.png\"\n\n---\n\n\"\"\"</span></span></code></pre></div>\n<h3>create markdown file</h3>\n<p>Now its time to get down to business and make the post.  First I want to throw\nan error if the post already exists, I definitely dont want to blow away an\nexisting post if a certain slug is already taken.  I am a big fan of custom\nerror messages and I am going to go ahead and make one here, even though this\nis just a quick script.</p>\n<p><em><small><mark>custom error</mark></small></em></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">PostExistsError</span><span class=\"token punctuation\">(</span>FileExistsError<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">pass</span></code></pre></div>\n<p>I am a <code class=\"language-text\">pathlib</code> superfan.  It's going to make setting up these paths super\nsimple.  Note I am going to anchor my directory down with the <code class=\"language-text\">__file__</code>\nvariable.  I do this all the time to get paths relative to the module that is\ncurrently running.</p>\n<p><em><small><mark>setup paths</mark></small></em></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">directory <span class=\"token operator\">=</span> pathlib<span class=\"token punctuation\">.</span>Path<span class=\"token punctuation\">(</span>__file__<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>parent\npath <span class=\"token operator\">=</span> pathlib<span class=\"token punctuation\">.</span>Path<span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>directory<span class=\"token punctuation\">}</span></span><span class=\"token string\">/src/pages/blog/</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>slug<span class=\"token punctuation\">}</span></span><span class=\"token string\">.md\"</span></span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">if</span> path<span class=\"token punctuation\">.</span>exists<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">raise</span> PostExistsError<span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"Post Already exists at </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>path<span class=\"token punctuation\">}</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span></code></pre></div>\n<blockquote>\n<p><strong>file</strong> is a string that represents the path to the running module</p>\n</blockquote>\n<p>Finally just write the file.  Here we open the file with a context manager so\nthat we don't have to worry about closing it when we are done.  Note that we\nopen it with the <code class=\"language-text\">w+</code> flag for write and creation.</p>\n<p><em><small><mark>write the file</mark></small></em></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">with</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">,</span> <span class=\"token string\">\"w+\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> f<span class=\"token punctuation\">:</span>\n    f<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span>frontmatter<span class=\"token punctuation\">)</span></code></pre></div>\n<h3>git add</h3>\n<p>I am not quite ready to pull the trigger on doing an auto commit, but this may\nhappen in a future version.  For now I want this file easily picked up by vims\n<code class=\"language-text\">:GFiles</code> since I have that is one of my most used hot keys.  To do this the\nfile at least needs added.  I'm sure there is a better way to do this with a\nGit library, but I am used to the command line so I am going to just run a\nsubprocess.</p>\n<p>I am using the <code class=\"language-text\">subprocess.Popen</code> command since its what I am used to, note\nthat it will run the task in the background so be sure that you wait on it.\nThe <code class=\"language-text\">Popen</code> is great if you have several task that are not dependent on each\nother.</p>\n<p><em><small><mark>git add <new-post></mark></small></em></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">gadd <span class=\"token operator\">=</span> subprocess<span class=\"token punctuation\">.</span>Popen<span class=\"token punctuation\">(</span>\n    <span class=\"token string-interpolation\"><span class=\"token string\">f'cd </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>directory<span class=\"token punctuation\">}</span></span><span class=\"token string\"> &amp;&amp; git add </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>replace<span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>directory<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">\"/\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token string\"> '</span></span><span class=\"token punctuation\">,</span>\n    shell<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">)</span>\ngadd<span class=\"token punctuation\">.</span>wait<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h3>open in neovim</h3>\n<p>Last step of the script is to start writing, I want to be open in my blogs\ndirectory (hence the cd), with the file open, to the right line (+11), and in\ninsert mode (+star).</p>\n<p><em><small><mark>open post in neovim</mark></small></em></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">nvim <span class=\"token operator\">=</span> subprocess<span class=\"token punctuation\">.</span>Popen<span class=\"token punctuation\">(</span>\n    <span class=\"token string-interpolation\"><span class=\"token string\">f'cd </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>directory<span class=\"token punctuation\">}</span></span><span class=\"token string\"> &amp;&amp; nvim +12 +star </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>replace<span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>directory<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">\"/\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token string\"> '</span></span><span class=\"token punctuation\">,</span>\n    shell<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">)</span>\nnvim<span class=\"token punctuation\">.</span>wait<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h2>Alias</h2>\n<p>Now I want this script to be available everywhere.  I am going to simply add\nthe following entry to shorten the script and eliminate the need to use the\nfull path.  I added this to my <code class=\"language-text\">~/.alias</code>, for you it may be <code class=\"language-text\">~/.bashrc</code>, or\n<code class=\"language-text\">~/.zshrc</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token builtin class-name\">alias</span> <span class=\"token assign-left variable\">np</span><span class=\"token operator\">=</span>~/git/waylonwalkerv2/new-post</code></pre></div>\n<h2>Starting a new post</h2>\n<p>Lets start a new post about automating my posts in python.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">np <span class=\"token string\">\"automating my posts\"</span> python</code></pre></div>\n<h2>This is my workflow</h2>\n<p>Ad hoc scripts like this can be a bit of a hot mess, partly due to the just get\nit done nature, but also due to the fact that I am just riffing off the top of\nmy head and utilizing docs as least as possible.</p>\n<p>While writing the script I would run it after each section or so and print some\nresults to make sure they were looking good. If I ever needed access to a live\nvariable I would pop open ipython and run <code class=\"language-text\">%run new-post &quot;my-new-post&quot;</code> and\ninspecting it.</p>\n<h2>Final Script</h2>\n<p><em><small><mark>final script</mark></small></em></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\">#!python</span>\n<span class=\"token comment\"># new-post</span>\n\n<span class=\"token keyword\">import</span> sys\n<span class=\"token keyword\">import</span> datetime\n<span class=\"token keyword\">import</span> pathlib\n<span class=\"token keyword\">import</span> subprocess\n\n\ntitle <span class=\"token operator\">=</span> sys<span class=\"token punctuation\">.</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>titlecase<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nargs <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>sys<span class=\"token punctuation\">.</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\ntags <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n\n<span class=\"token keyword\">if</span> <span class=\"token string\">\"py\"</span> <span class=\"token keyword\">in</span> args<span class=\"token punctuation\">:</span>\n    tags<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token string\">\"python\"</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">if</span> <span class=\"token string\">\"web\"</span> <span class=\"token keyword\">in</span> args<span class=\"token punctuation\">:</span>\n    tags<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token string\">\"webdev\"</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">if</span> <span class=\"token string\">\"blog\"</span> <span class=\"token keyword\">in</span> args<span class=\"token punctuation\">:</span>\n    tags<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token string\">\"blog\"</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">if</span> <span class=\"token string\">\"data\"</span> <span class=\"token keyword\">in</span> args<span class=\"token punctuation\">:</span>\n    tags<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token string\">\"data\"</span><span class=\"token punctuation\">)</span>\n\nslug <span class=\"token operator\">=</span> title<span class=\"token punctuation\">.</span>lower<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>replace<span class=\"token punctuation\">(</span><span class=\"token string\">\" \"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"-\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>replace<span class=\"token punctuation\">(</span><span class=\"token string\">\"_\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"-\"</span><span class=\"token punctuation\">)</span>\nfrontmatter <span class=\"token operator\">=</span> <span class=\"token string-interpolation\"><span class=\"token string\">f\"\"\"---\ntemplateKey: blog-post\ntags: </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>tags<span class=\"token punctuation\">}</span></span><span class=\"token string\">\ntitle: </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>title<span class=\"token punctuation\">}</span></span><span class=\"token string\">\ndate: </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>datetime<span class=\"token punctuation\">.</span>date<span class=\"token punctuation\">.</span>today<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>strftime<span class=\"token punctuation\">(</span><span class=\"token string\">'%Y-%m-%dT%H:%M:%S'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token string\">\nstatus: draft\ndescription: ''\ncover: \"/static/</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>slug<span class=\"token punctuation\">}</span></span><span class=\"token string\">.png\"\n\n---\n\n\n\"\"\"</span></span>\n\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">PostExistsError</span><span class=\"token punctuation\">(</span>FileExistsError<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">pass</span>\n\n\ndirectory <span class=\"token operator\">=</span> pathlib<span class=\"token punctuation\">.</span>Path<span class=\"token punctuation\">(</span>__file__<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>parent\npath <span class=\"token operator\">=</span> pathlib<span class=\"token punctuation\">.</span>Path<span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>directory<span class=\"token punctuation\">}</span></span><span class=\"token string\">/src/pages/blog/</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>slug<span class=\"token punctuation\">}</span></span><span class=\"token string\">.md\"</span></span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">if</span> path<span class=\"token punctuation\">.</span>exists<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">raise</span> PostExistsError<span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"Post Already exists at </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>path<span class=\"token punctuation\">}</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">with</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">,</span> <span class=\"token string\">\"w+\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> f<span class=\"token punctuation\">:</span>\n    f<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span>frontmatter<span class=\"token punctuation\">)</span>\n\ngadd <span class=\"token operator\">=</span> subprocess<span class=\"token punctuation\">.</span>Popen<span class=\"token punctuation\">(</span>\n    <span class=\"token string-interpolation\"><span class=\"token string\">f'cd </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>directory<span class=\"token punctuation\">}</span></span><span class=\"token string\"> &amp;&amp; git add </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>replace<span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>directory<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">\"/\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token string\"> '</span></span><span class=\"token punctuation\">,</span>\n    shell<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">)</span>\ngadd<span class=\"token punctuation\">.</span>wait<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\nnvim <span class=\"token operator\">=</span> subprocess<span class=\"token punctuation\">.</span>Popen<span class=\"token punctuation\">(</span>\n    <span class=\"token string-interpolation\"><span class=\"token string\">f'cd </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>directory<span class=\"token punctuation\">}</span></span><span class=\"token string\"> &amp;&amp; nvim +12 +star </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>replace<span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>directory<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">\"/\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token string\"> '</span></span><span class=\"token punctuation\">,</span>\n    shell<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">)</span>\nnvim<span class=\"token punctuation\">.</span>wait<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<a class=\"onelinelink\" href=\"https://waylonwalker.com/quickly-edit-posts/\">\n<img style=\"float: right;\" align=\"right\" src=\"https://waylonwalker.com/static/fd0bd45e6a1500a02b7f796ae7294550/630fb/quickly-edit-posts-xmas2020.png\" alt=\"article cover for Quickly Edit Posts\">\n<div class=\"right\">\n    <h2>Quickly Edit Posts</h2>\n    <p class=\"description\">\n    Recently I automated starting new posts with a python script. Today I want to work on the next part that is editing tho\n    </p>\n    <p class=\"url\">\n    <span class=\"read-more\">read more</span>  waylonwalker.com\n    </p>\n</div>\n</a>\n<blockquote>\n<p>check out the next article in this series where I setup a bash function to quickly edit these posts</p>\n</blockquote>","fields":{"slug":"/automating-my-post-starter/"},"frontmatter":{"tags":["blog","python"],"title":"Automating my Post Starter","description":"One thing we all dread is mundane work of getting started, and all the hoops it takes to get going. This year I want to","templateKey":"blog-post","status":"published","date":"2020-12-11T09:08","cover":{"med_img":{"fixed":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAABnUlEQVQY02WQQW/TQBCFc+SIGqCxY9ep1wl21t6ZteNs7NiJ40YppbSlwAU13JBohNSWFkKkClpRqUK9IvFL+IGMK3FCenparfbNfPtqpiOtNuodueFIs4PkOt0w0NtgONL1EoACxBhFjjgUYR5BAmEq5QClqtELowqEBsOmgwaTOiMHjWSD1Y5cPxOC8iOALJAZQiJkCnIAsl+jPZojGzZoDjbboV4NQo3hug2tp8rj4yYLfVHwIA9ELjATOAww8VEJvA83NoXN1ZOWWGt6dbP7aIOT6PDY9JmbMJ4wR0W9KfeHbpfG9blQAQ6qMDE/tPyLq9uL1fWXy5sPJ8uz5ffj09Xu63fvP37eeTU/X10fL5ZH88Xd3a9P55ffrm4PDt96fg/oz2s2BibfVUVv8iIt96LsmUxn8WiHPMq2hSqD/mRcHibp89n2m8nW/nT2UqUlF31B4ZaLf37e/DhaPGh06kaF/U/35JZPrm1Cl+euNyBstxvzQIFMKmwB8PvrfC/dr1sBFUZV/a8Go/LiEIsk2iri2SieZlHJ3N5f5HFjFRkziMkAAAAASUVORK5CYII=","width":500,"height":210,"src":"/static/d4770ec76e0f29cf7536bccfee99340b/46604/automating-my-post-starter-xmas2020.png","srcSet":"/static/d4770ec76e0f29cf7536bccfee99340b/46604/automating-my-post-starter-xmas2020.png 1x,\n/static/d4770ec76e0f29cf7536bccfee99340b/d8815/automating-my-post-starter-xmas2020.png 1.5x,\n/static/d4770ec76e0f29cf7536bccfee99340b/31987/automating-my-post-starter-xmas2020.png 2x"}},"childImageSharp":{"fixed":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsTAAALEwEAmpwYAAABy0lEQVQoz4WQXU8TQRSGe+OdWYpa6c7SbezMfnS3M3Nmd+m2+wFtSjVUSCOt1EJBqiV+QCURYv0g0RhvJPHGa+N/8Z85hSuvTN6LNyfPk5xzMroByBQFInQTCsTTCCxj0AlTDShiYbsRsCbla0BTATH1Up9F3KsD1LkIM5JWiUAYZNEwIAKyI8zzmKslrht+2U0oW2MsZTymkACPmKgzqM1liUpI+prhySBDqHKChZSdSsOwE90IGGu6NKV8lYmUQcwgqkCNQZi5QmFRKyuqeXOJKHlzUbMXVCur2XdQpWTX80Vu2RGDhmWHxAwMyzfLPr2WFa08nX2++Pr9xZt3Ryfnk+Oz6flFd3DY2R7tT6bdwXj26Vuv9+z18ezy8ufk6PT9hy+D4dhh1bm8lCu14/bO4SvJbfYPpPOgO9x4NAobD/t7Ex62tvpPNzrD9fv90f7L7d7BcPd5Z/OxS1fmN/86ffvjyfhGDmdVS267gKwssuUVtwuOolq5IlWQWSSB6ybECAw7wJYwHd+BkEE18+f3x7Odk1vLFUSuX/Vv5C+viuXGgWjWvNZq0E6CVmNlXfA4kwRgEn73Hs+X/hNsVymNBU8piywn1LD4C7lab2zUNLtcAAAAAElFTkSuQmCC","width":200,"height":85,"src":"/static/d4770ec76e0f29cf7536bccfee99340b/71e30/automating-my-post-starter-xmas2020.png","srcSet":"/static/d4770ec76e0f29cf7536bccfee99340b/71e30/automating-my-post-starter-xmas2020.png 1x,\n/static/d4770ec76e0f29cf7536bccfee99340b/24123/automating-my-post-starter-xmas2020.png 1.5x,\n/static/d4770ec76e0f29cf7536bccfee99340b/492a0/automating-my-post-starter-xmas2020.png 2x"}}}}},"next":{"id":"362278e4-41d7-5211-8b3d-cea698a1887b","html":"<p>Nesting loops inside of each other in python makes for much harder code to understand, it takes more brain power to understand, and is thus more error prone than if its avoidable.  One issue with this complexity is that toy examples may make sense, but most real example will grow and become more deeply nested over time.  Avoiding this complexity from the start can help simplify the project in the future.</p>\n<h2>setup</h2>\n<p>Lets take a pretty simple example where we are using a ficticious library to get some sales data for our transportation company.  The api allows us to fetch teh sales data for one class of vehicle and one region at a time.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> pandas <span class=\"token keyword\">as</span> pd\n\n<span class=\"token keyword\">from</span> datastore <span class=\"token keyword\">import</span> get_sales  <span class=\"token comment\"># ficticious library</span>\n\ncars <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'sedan'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'coupe'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'hatchback'</span><span class=\"token punctuation\">]</span>\nregions <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'US'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'CA'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'MX'</span><span class=\"token punctuation\">]</span></code></pre></div>\n<h2>‚ùå Nesting Loops</h2>\n<p>We have setup to fetch our data with two lists that represent the vehicles and regions that we want to analyze.  We know that we need to make a call to <code class=\"language-text\">get_sales</code> for every vehicle and region so nesting loops is a very common first solution to jump to.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">sales <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>DataFrame<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">for</span> car <span class=\"token keyword\">in</span> cars<span class=\"token punctuation\">:</span>\n   <span class=\"token keyword\">for</span> region <span class=\"token keyword\">in</span> regions<span class=\"token punctuation\">:</span>\n      new_sales <span class=\"token operator\">=</span> get_sales<span class=\"token punctuation\">(</span>car<span class=\"token punctuation\">,</span> region<span class=\"token punctuation\">)</span>\n      sales <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>concat<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>sales<span class=\"token punctuation\">,</span> new_sales<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h2>itertools.product</h2>\n<p>Python provides us with the beautiful itertools module that allows us to prepare our inputs for this in a much more susynct manner.  The product function of itertools will give us every combination of any number of iterables</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> itertools\n<span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span>itertools<span class=\"token punctuation\">.</span>product<span class=\"token punctuation\">(</span>cars<span class=\"token punctuation\">,</span> regions<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<blockquote>\n<p>note that itertools returns a generator for most if not all functions, list() will turn that into a list that we can see.  This works great for small datasets, but might not be advisable on larger ones.</p>\n</blockquote>\n<p><strong>output</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token string\">'sedan'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'US'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n <span class=\"token punctuation\">(</span><span class=\"token string\">'sedan'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'CA'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n <span class=\"token punctuation\">(</span><span class=\"token string\">'sedan'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'MX'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n <span class=\"token punctuation\">(</span><span class=\"token string\">'coupe'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'US'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n <span class=\"token punctuation\">(</span><span class=\"token string\">'coupe'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'CA'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n <span class=\"token punctuation\">(</span><span class=\"token string\">'coupe'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'MX'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n <span class=\"token punctuation\">(</span><span class=\"token string\">'hatchback'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'US'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n <span class=\"token punctuation\">(</span><span class=\"token string\">'hatchback'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'CA'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n <span class=\"token punctuation\">(</span><span class=\"token string\">'hatchback'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'MX'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span></code></pre></div>\n<h2>itertools.procuct for loop</h2>\n<p>Now that we have every comination of our two sets of inputs in a single list, we can iterate over that list one time.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">sales <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>DataFrame<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">for</span> car<span class=\"token punctuation\">,</span> region <span class=\"token keyword\">in</span> itertools<span class=\"token punctuation\">.</span>product<span class=\"token punctuation\">(</span>cars<span class=\"token punctuation\">,</span> regions<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n   new_sales <span class=\"token operator\">=</span> get_sales<span class=\"token punctuation\">(</span>car<span class=\"token punctuation\">,</span> region<span class=\"token punctuation\">)</span>\n   sales <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>concat<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>sales<span class=\"token punctuation\">,</span> new_sales<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h2>itertools.product list comprehension</h2>\n<p>The above follows a python anti-pattern, initialize then edit.  In some cases it might be a bit more readable to do it that way, you can be the judge, but in our simple case we can simply achieve the same results using a list comprehension.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">pd<span class=\"token punctuation\">.</span>concat<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>get_sales<span class=\"token punctuation\">(</span>cars<span class=\"token punctuation\">,</span> region<span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> cars<span class=\"token punctuation\">,</span> region <span class=\"token keyword\">in</span> itertools<span class=\"token punctuation\">.</span>product<span class=\"token punctuation\">(</span>cars<span class=\"token punctuation\">,</span> regions<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h2>dictionaries</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">sales_args <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n   <span class=\"token string\">'cars'</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'sedan'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'coupe'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'hatchback'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n   <span class=\"token string\">'regions'</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'US'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'CA'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'MX'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span>\n\npd<span class=\"token punctuation\">.</span>concat<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>get_sales<span class=\"token punctuation\">(</span><span class=\"token operator\">*</span>sales_arg<span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> sales_arg <span class=\"token keyword\">in</span> itertools<span class=\"token punctuation\">.</span>product<span class=\"token punctuation\">(</span><span class=\"token operator\">*</span>sales_args<span class=\"token punctuation\">.</span>values<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">sales_args <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n   <span class=\"token string\">'cars'</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'sedan'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'coupe'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'hatchback'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n   <span class=\"token string\">'regions'</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'US'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'CA'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'MX'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n   <span class=\"token string\">'month'</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'MAR'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'APR'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'MAY'</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span>\n\npd<span class=\"token punctuation\">.</span>concat<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>get_sales<span class=\"token punctuation\">(</span><span class=\"token operator\">*</span>sales_arg<span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> sales_arg <span class=\"token keyword\">in</span> product<span class=\"token punctuation\">(</span><span class=\"token operator\">*</span>sales_args<span class=\"token punctuation\">.</span>values<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></code></pre></div>\n<hr>\n<h2>Chaining</h2>\n<p><em>containers of containers</em></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">vehicles <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token string\">'cars'</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'sedan'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'coupe'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'hatchback'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'trucks'</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'light'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'heavy'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'sport'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'offroad'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'van'</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'box'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'mini'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'full'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">for vehicle in vehicles:\n\tfor sub_class in vehicles[vehicle]:\n      new_sales = get_sales(sub_class)\n      new_sales[&#39;sub_class&#39;] = sub_class\n      new_sales[&#39;vehicle&#39;] = vehicle\n      sales = pd.concat([sales, new_sales])</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"> list(itertools.chain(*[list(itertools.product([k], v)) for k, v in vehicles.items()]))</code></pre></div>\n<p>output</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">[(&#39;cars&#39;, &#39;sedan&#39;),\n (&#39;cars&#39;, &#39;coupe&#39;),\n (&#39;cars&#39;, &#39;hatchback&#39;),\n (&#39;trucks&#39;, &#39;light&#39;),\n (&#39;trucks&#39;, &#39;heavy&#39;),\n (&#39;trucks&#39;, &#39;sport&#39;),\n (&#39;trucks&#39;, &#39;offroad&#39;),\n (&#39;van&#39;, &#39;box&#39;),\n (&#39;van&#39;, &#39;mini&#39;),\n (&#39;van&#39;, &#39;full&#39;)]</code></pre></div>","fields":{"slug":"/avoid-nesting-loops-in-python/"},"frontmatter":{"tags":[],"title":"Avoid Nesting Loops in Python","description":"Nesting loops inside of each other in python makes for much harder code to understand, it takes more brain power to unde","templateKey":"blog-post","status":"draft","date":"2020-10-11T05:00:00.000Z","cover":{"med_img":{"fixed":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAABgklEQVQY032RyUoDQRCGc/cWE81kmSTTMbP0Vp1ZMqOdONFEXHC/aUBF9CAGPLggelAU9Al8E9/PmoAXD8JPU930X/X137lqS6EMoqpEVVowXbGWBsqS9QXfoUtCpEL0JGiuNMhEqEWpYqmiXBmdmRlKlsS6RGC+KUrTbb0duTQ12wHly1T0GddCag5LXCYMugKm5jKB6oKq2X6hzrCL6YTFOps1adlSxI7nTO56mstl1Rm4XtdjXQ4JhzgzVwgUCBhOdPv4enXzuHU4vn9+Pzq7upzcbewfjy8ml9d3u3snB4en9w8vT8/vZ+fXiM1xsurm8hbwmhdZrB2kEA8JS2zQLBzQIHU7fRkPIRl1wlEQjnRvc7C6o/vriJ1Nxjc3HPj+fPs4mcxU3KJJ5xocmQsmimbwNZqveVXSobzn0UXnFxsDy7CFlF8P461kO2+y8jS5P8pSxPDsQMk08YdpuNYLVrW/QuwgV2wKo0GNJscb/2i+KTFXyw5bbtSwffxIPPkBvu5dZCkdmSUAAAAASUVORK5CYII=","width":500,"height":210,"src":"/static/83aa845b95a47f9f95ad621e6a3f2555/46604/avoid-nesting-loops-in-python-xmas2020.png","srcSet":"/static/83aa845b95a47f9f95ad621e6a3f2555/46604/avoid-nesting-loops-in-python-xmas2020.png 1x,\n/static/83aa845b95a47f9f95ad621e6a3f2555/d8815/avoid-nesting-loops-in-python-xmas2020.png 1.5x,\n/static/83aa845b95a47f9f95ad621e6a3f2555/31987/avoid-nesting-loops-in-python-xmas2020.png 2x"}},"childImageSharp":{"fixed":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsTAAALEwEAmpwYAAABwUlEQVQoz32Q227TQBCGfcsVLWlDfIgjsl6f1rs7aztO4kOcpkBQmoJaSipQ1HKQEkQhEQeposAFF7wAt0i8C2/GOiAukX6N/hnNpzkoJg5NDJotmpYwbWhaoW6BgcC0mIqhhYRLUmB7lJdACwEZDYuIpTzsA/QV3RKyW7WEhkAaHYFmgfQa4g3E1TY3ceSRnLKSsYLxjEIOPGWiz6CnaJZQEUg1JIBDmTbaXK2KVd3xBy4ZtJyYsWHABpQVHAoucsr7QQVvyApu8y3N3TGJ5KW5YXjXNbuFk5tNtmMQz889kgU0w04H26GE6V/YjnYRfLj6ulxdHj1+8XJ1+eb9pyfPL2ZnywenT8+X6/mz19PD+fzs1Wr98fOXb4vFWsRFwLtKHQmtgbHhdkeH5fg4yu/5UTmanCTlpLh7FOXj/YNHw/Fxlk8H5f3J5PThyfnBdMZFVk2uI/5j9fb7fHFNc+SqtSbZbQVy7VrT39a9mkm2dFeqbSckyB2vi50YezFhPZ8nSifkv35evZtdbOvy2ury6mGbF2wi/PMOSWOx1wtHRXwni/aHnduKYbE8Btvi9Vv8D/kfITehNBO8oCx1/O5vKF5qEf5ulMgAAAAASUVORK5CYII=","width":200,"height":85,"src":"/static/83aa845b95a47f9f95ad621e6a3f2555/71e30/avoid-nesting-loops-in-python-xmas2020.png","srcSet":"/static/83aa845b95a47f9f95ad621e6a3f2555/71e30/avoid-nesting-loops-in-python-xmas2020.png 1x,\n/static/83aa845b95a47f9f95ad621e6a3f2555/24123/avoid-nesting-loops-in-python-xmas2020.png 1.5x,\n/static/83aa845b95a47f9f95ad621e6a3f2555/492a0/avoid-nesting-loops-in-python-xmas2020.png 2x"}}}}},"similarPosts":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]}},"staticQueryHashes":["2992646504"]}