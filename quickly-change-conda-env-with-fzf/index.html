<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="utf-8"/>
  <!-- <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" /> -->
  <meta content="width=device-width" name="viewport"/>
  <link href="/8bitcc_48x.png" rel="icon" type="image/png"/>
  <meta content="$ilp.uphold.com/MGN2ni2YMXaQ" name="monetization" property="monetization"/>
  <link href="/furo-purge.css" rel="stylesheet"/>
  <link href="/monokai.css" rel="stylesheet"/>
  <link href="/archive-styles.css" rel="stylesheet"/>
  <title>
   Quickly Change Conda Env With Fzf
  </title>
  <meta content="article" name="og:type" property="og:type"/>
  <meta content="Waylon Walker" name="og:author" property="og:author"/>
  <meta content="Waylon Walker" name="og:site_name" property="og:site_name"/>
  <meta content="Changing conda environments is a bit verbose, I use a function with fzf that
both lists environments and selects the one I want in one go. I have used conda as a virtual environment tool for years now.  I started using
conda for its simplicity to ins" name="description" property="description"/>
  <meta content="Changing conda environments is a bit verbose, I use a function with fzf that
both lists environments and selects the one I want in one go. I have used conda as a virtual environment tool for years now.  I started using
conda for its simplicity to ins" name="og:description" property="og:description"/>
  <meta content="Changing conda environments is a bit verbose, I use a function with fzf that
both lists environments and selects the one I want in one go. I have used conda as a virtual environment tool for years now.  I started using
conda for its simplicity to ins" name="twitter:description" property="twitter:description"/>
  <meta content="Quickly Change Conda Env With Fzf" name="og:title" property="og:title"/>
  <meta content="Quickly Change Conda Env With Fzf" name="twitter:title" property="twitter:title"/>
  <meta content="Quickly Change Conda Env With Fzf" name="title" property="title"/>
  <link href="/manifest.json" rel="manifest"/>
 </head>
 <body>
  <nav>
   <ul>
    <li>
     <a href="https://waylonwalker.com">
      Home
     </a>
    </li>
    <li>
     <a href="https://waylonwalker.com/archive">
      Archive
     </a>
    </li>
    <li>
     <a aria-label="RSS" href="https://waylonwalker.com/rss">
      <svg class="icon" height="16" viewbox="0 0 24 24" width="16" xmlns="http://www.w3.org/2000/svg">
       <path d="M 4 4.44 v 2.83 c 7.03 0 12.73 5.7 12.73 12.73 h 2.83 c 0 -8.59 -6.97 -15.56 -15.56 -15.56 Z m 0 5.66 v 2.83 c 3.9 0 7.07 3.17 7.07 7.07 h 2.83 c 0 -5.47 -4.43 -9.9 -9.9 -9.9 Z M 6.18 15.64 A 2.18 2.18 0 0 1 6.18 20 A 2.18 2.18 0 0 1 6.18 15.64" fill="currentColor">
       </path>
      </svg>
     </a>
    </li>
   </ul>
  </nav>
  <article class="blog-post h-entry">
   <p>
    Changing conda environments is a bit verbose, I use a function with fzf that
both lists environments and selects the one I want in one go.
   </p>
   <h2>
    Conda
   </h2>
   <p>
    I have used conda as a virtual environment tool for years now.  I started using
conda for its simplicity to install packages on windows, but now that has
gotten so much better and it's been years since I have run a
    <code>
     conda install
    </code>
    command.  I'm sure that I could use a different environment manager, but it
works for me and makes sense.
   </p>
   <blockquote>
    <p>
     What environment manager do you use for python?
    </p>
   </blockquote>
   <p>
    Conda environments are stored in a central location such as
    <code>
     ~/miniconda3/envs/
    </code>
    and not with the project.  They contain both the python
interpreter and packages for that env.
   </p>
   <h2>
    Conda create
   </h2>
   <p>
    Conda environments are created with the
    <code>
     conda create
    </code>
    command.  At this point,
you will need to name your env and select the python version.
   </p>
   <pre class="highlight"><code class="language-bash">conda create -n my_env python=3.8</code></pre>
   <p>
    After running this command you will have a directory
    <code>
     ~/miniconda3/envs/my_env
    </code>
    with a base python install.  It will not be active yet.
   </p>
   <h2>
    List environments
   </h2>
   <p>
    Before activating an environment I often want to list the environments that I
have installed which are often upwards of 70, so it's hard to remember them
all.
   </p>
   <pre class="highlight"><code class="language-bash">conda info --envs</code></pre>
   <p>
    After running this command you will see something like the following.
   </p>
   <pre class="highlight"><code class="language-bash"># conda environments:
#
base                     /home/waylon/miniconda3
my_env                   /home/waylon/my_env</code></pre>
   <h2>
    Activating an environment
   </h2>
   <p>
    Activating a conda environment will do some magic to your current shells
    <code>
     $PATH
    </code>
    variable to ensure that the environment that you select is preferred
over the base environment.
   </p>
   <pre class="highlight"><code class="language-bash">conda activate my_env</code></pre>
   <h2>
    Ready to work
   </h2>
   <p>
    Now you can install packages for your project in an isolated environment safe
from wrecking another project or being wrecked by another project.
   </p>
   <pre class="highlight"><code class="language-bash">pip install -r requirements.txt</code></pre>
   <h2>
    Using fzf
   </h2>
   <p>
    <em>
     a bit less verbose
    </em>
   </p>
   <p>
    <a href="https://github.com/junegunn/fzf">
     fzf
    </a>
    is an amazing tool for the terminal that
is a generic fuzzy matcher.  It is super performant and can handle insane
amounts of text and is brilliant at figuring out what you mean with just a few
characters.  We can use it here to list out all of our conda environments and
select the one we want to activate with just a few keystrokes.
   </p>
   <h3>
    Selecting the environment.
   </h3>
   <p>
    Piping our list of environments directly into
    <code>
     fzf
    </code>
    gives us a fuzzy selection
where we can type a few characters and it will return the row we were looking
for.
   </p>
   <pre class="highlight"><code class="language-bash">conda info --envs | fzf</code></pre>
   <p>
    This returns us something like this which also includes the path where it is
located.
   </p>
   <pre class="highlight"><code class="language-bash">my_env                 /home/walkews/miniconda3/envs/my_env</code></pre>
   <h3>
    getting just the environment name
   </h3>
   <p>
    To get just the name without the path I pipe the output into awk.  There are
many ways to do this in bash, this is the way that worked for me at the time I
made this function.
   </p>
   <pre class="highlight"><code class="language-bash">conda info --envs | fzf | awk '{print $1}'</code></pre>
   <h3>
    Time to activate
   </h3>
   <p>
    Functions that use
    <code>
     fzf
    </code>
    can be a bit odd, running them in a subshell with the
$() syntax generally makes it super simple to utilize the output.  No matter
how many times I have tried without running it in a subshell it's always buggy
without it.
   </p>
   <pre class="highlight"><code class="language-bash">conda activate "$(conda info --envs | fzf | awk '{print $1}')"</code></pre>
   <p>
    This will now run conda activate on the environment that we select with fzf.
   </p>
   <h3>
    Make it a function
   </h3>
   <p>
    We don't want to type that out every time we want to activate an environment. I
keep a function called
    <code>
     a
    </code>
    in my
    <code>
     ~/.bashrc
    </code>
    and
    <code>
     ~/.zshrc
    </code>
    so that I can
activate an environment with a single character.  Yes, I switch environments
often enough to justify the valuable namespace of a single character.
   </p>
   <pre class="highlight"><code class="language-bash">a () {
  conda activate "$(conda info --envs | fzf | awk '{print $1}')"
}</code></pre>
   <p>
    <a href="https://waylonwalker.com/reusable-bash">
     https://waylonwalker.com/reusable-bash
    </a>
   </p>
   <blockquote>
    <p>
     for more information on writing reusable bash scripts check out one of my
favorite articles
    </p>
   </blockquote>
   <p>
    I am always on the lookout for cool new use cases for
    <code>
     fzf
    </code>
    , if you have one please share it with me.
   </p>
   <div id="show">
   </div>
  </article>
 </body>
 <script>
  if ('serviceWorker' in navigator) {
  window.addEventListener('load', function() {
    navigator.serviceWorker.register('/service-worker.js').then(function(registration) {
      // Registration was successful
      console.log('ServiceWorker registration successful with scope: ', registration.scope);
    }, function(err) {
      // registration failed :(
      console.log('ServiceWorker registration failed: ', err);
    });
  });
}
 </script>
</html>