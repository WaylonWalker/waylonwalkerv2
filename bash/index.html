<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="utf-8"/>
  <!-- <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" /> -->
  <meta content="width=device-width" name="viewport"/>
  <link href="/8bitcc_48x.png" rel="icon" type="image/png"/>
  <meta content="$ilp.uphold.com/MGN2ni2YMXaQ" name="monetization" property="monetization"/>
  <link href="/furo-purge.css" rel="stylesheet"/>
  <link href="/monokai.css" rel="stylesheet"/>
  <link href="/archive-styles.css" rel="stylesheet"/>
  <title>
   Bash
  </title>
  <meta content="article" name="og:type" property="og:type"/>
  <meta content="Waylon Walker" name="og:author" property="og:author"/>
  <meta content="Waylon Walker" name="og:site_name" property="og:site_name"/>
  <meta content="Waylon Walker's Bash Notes" name="description" property="description"/>
  <meta content="Waylon Walker's Bash Notes" name="og:description" property="og:description"/>
  <meta content="Waylon Walker's Bash Notes" name="twitter:description" property="twitter:description"/>
  <meta content="Bash" name="og:title" property="og:title"/>
  <meta content="Bash" name="twitter:title" property="twitter:title"/>
  <meta content="Bash" name="title" property="title"/>
  <link href="/manifest.json" rel="manifest"/>
 </head>
 <body>
  <nav>
   <ul>
    <li>
     <a href="https://waylonwalker.com">
      Home
     </a>
    </li>
    <li>
     <a href="https://waylonwalker.com/archive">
      Archive
     </a>
    </li>
    <li>
     <a aria-label="RSS" href="https://waylonwalker.com/rss">
      <svg class="icon" height="16" viewbox="0 0 24 24" width="16" xmlns="http://www.w3.org/2000/svg">
       <path d="M 4 4.44 v 2.83 c 7.03 0 12.73 5.7 12.73 12.73 h 2.83 c 0 -8.59 -6.97 -15.56 -15.56 -15.56 Z m 0 5.66 v 2.83 c 3.9 0 7.07 3.17 7.07 7.07 h 2.83 c 0 -5.47 -4.43 -9.9 -9.9 -9.9 Z M 6.18 15.64 A 2.18 2.18 0 0 1 6.18 20 A 2.18 2.18 0 0 1 6.18 15.64" fill="currentColor">
       </path>
      </svg>
     </a>
    </li>
   </ul>
  </nav>
  <article class="blog-post h-entry">
   <h1>
    Bash Notes
   </h1>
   <p>
    Bash is super powerful.
   </p>
   <h2>
    File System Full
   </h2>
   <p>
    <strong>
     Show Remaining Space on Drives
    </strong>
   </p>
   <pre class="highlight"><code class="language-bash">df -h</code></pre>
   <p>
    <strong>
     show largest files in current directory
    </strong>
   </p>
   <pre class="highlight"><code class="language-bash">du . -h --max-depth=1</code></pre>
   <p>
    <strong>
     Move files then symlink them
    </strong>
   </p>
   <pre class="highlight"><code class="language-bash">mkdir /mnt/mounted_drive
mv ~/bigdir /mnt/mounted_drive
ln -s /mnt/mounted_drive/bigdir ~/bigdir</code></pre>
   <h2>
    Fuzzy One Liners
   </h2>
   <pre class="highlight"><code class="language-bash">a() {source activate "$(conda info --envs | fzf | awk '{print $</code></pre>
   <p>
    <strong>
     edit in vim
    </strong>
   </p>
   <pre class="highlight"><code class="language-bash">vf() { fzf | xargs -r -I % $EDITOR % ;}</code></pre>
   <p>
    <strong>
     cat a file
    </strong>
   </p>
   <pre class="highlight"><code class="language-bash">vf() { fzf | xargs -r -I % $EDITOR % ;}</code></pre>
   <p>
    <strong>
     bash execute
    </strong>
   </p>
   <pre class="highlight"><code class="language-bash">bf() { bash "$(fzf)" }</code></pre>
   <p>
    <strong>
     git add
    </strong>
   </p>
   <pre class="highlight"><code class="language-bash">gadd() { git status -s | fzf -m | awk '{print $2}' | xargs git add &amp;&amp; git status -s}</code></pre>
   <p>
    <strong>
     git reset
    </strong>
   </p>
   <pre class="highlight"><code class="language-bash">greset() { git status -s |  fzf -m | awk '{print $2}' |xargs git reset &amp;&amp; git status -s}</code></pre>
   <p>
    <strong>
     Kill a process
    </strong>
   </p>
   <pre class="highlight"><code class="language-bash">fkill() {kill $(ps aux | fzf | awk '{print($2)}')}</code></pre>
   <h2>
    Finding things
   </h2>
   <h3>
    Files
   </h3>
   <p>
    <a href="https://github.com/sharkdp/fd">
     fd-find
    </a>
    is amazing for finding files, it even respects your
    <code>
     .gitignore
    </code>
    file üò≤.  Install with
    <code>
     apt install fd-find
    </code>
    .
   </p>
   <pre class="highlight"><code class="language-bash">fd md</code></pre>
   <pre class="highlight"><code class="language-bash">ag -g python</code></pre>
   <pre class="highlight"><code class="language-bash">find . -n "*.md"</code></pre>
   <p>
    <em>
     ++Vanilla Bonus
    </em>
   </p>
   <h3>
    Content
   </h3>
   <p>
    ** show matching text **
   </p>
   <pre class="highlight"><code class="language-bash">ag python</code></pre>
   <pre class="highlight"><code class="language-bash">grep -iR Python</code></pre>
   <p>
    <em>
     ++Vanilla Bonus
    </em>
   </p>
   <p>
    ** show file names only **
   </p>
   <pre class="highlight"><code class="language-bash">ag -l python</code></pre>
   <pre class="highlight"><code class="language-bash">grep -iRl python</code></pre>
   <p>
    <em>
     ++Vanilla Bonus
    </em>
   </p>
   <h3>
    Recursively Replace text
   </h3>
   <pre class="highlight"><code class="language-bash">agr() {ag -l "$1" | xargs sed -i "s/$1/$2/g"}</code></pre>
   <p>
    <em>
     ++Vanilla Bonus
    </em>
   </p>
   <pre class="highlight"><code class="language-bash">grepr() {grep -iRl "$1" | xargs sed -i "s/$1/$2/g"}</code></pre>
   <p>
    <strong>
     Extending
    </strong>
    <code>
     **agr**
    </code>
    <strong>
     or
    </strong>
    <code>
     **grepr**
    </code>
   </p>
   <p>
    There are so many options inside of
    <code>
     grep
    </code>
    ,
    <code>
     ag
    </code>
    , and
    <code>
     sed
    </code>
    that you could many an enormous amount of these if you really wanted to, but I like to keep it simple.  These cover 90% of my usage.  If I wanted to change something in the second half I would just paste in this command and edit it. More often though I want to limit the input, say only replace word1 to word2 inside of markdown files.
   </p>
   <p>
    <strong>
     Limited Scope
    </strong>
   </p>
   <pre class="highlight"><code class="language-bash">fd md | xargs argr python python3</code></pre>
   <pre class="highlight"><code class="language-bash">find . -n "*.md" | xargs grepr python python3</code></pre>
   <p>
    <em>
     ++Vanilla Bonus
    </em>
   </p>
   <p>
    <a href="https://waylonwalker.com/refactor-in-cli">
     https://waylonwalker.com/refactor-in-cli
    </a>
   </p>
   <blockquote>
    <p>
     I use these replace commands heavily when doing large refactorings.
    </p>
   </blockquote>
   <h3>
    conditionally configure
   </h3>
   <p>
    I like this one when there is not a good cli into config files and I need to replace something like a true to false if the value is in the config and append to the config if its not.
   </p>
   <pre class="highlight"><code class="language-bash">grepr() {
    # replaces first string with second string inside file from third argument
    # example:
    #   grepr "allow_conda_downgrades:.*" "allow_conda_downgrades: true" ~/.condarc
    if grep -xq $1 $3
    then
        sed -i "s|$1|$2|g" $3
    else
        echo "$2" &gt;&gt; $3
    fi
}</code></pre>
   <h3>
    Watch the time
   </h3>
   <pre class="highlight"><code class="language-bash">watch -n 1 date</code></pre>
   <p>
    <em>
     ++Vanilla Bonus
    </em>
   </p>
   <p>
    <strong>
     with figlet
    </strong>
   </p>
   <pre class="highlight"><code class="language-bash">watch -n 1 bash -c "date | figlet"</code></pre>
   <h3>
    watch a function
   </h3>
   <pre class="highlight"><code class="language-bash">run () {
date
aws s3 sync $BUCKET .
}
export -f run
watch -n 10 run</code></pre>
   <h3>
    if conda environment does not exist create it
   </h3>
   <pre class="highlight"><code class="language-bash">conda info --envs | grep my_env &amp;&amp; echo "my_env environment is installed" || conda create -n my_env python=3.8 -y
source activate my_env</code></pre>
   <h1>
    Rename multiple files
   </h1>
   <p>
    more info from
    <a href="https://linuxize.com/post/how-to-rename-files-in-linux/">
     linuxize
    </a>
   </p>
   <pre class="highlight"><code class="language-bash">for f in *.png; do
   mv ${f} prefix-${f}
done</code></pre>
   <h2>
    convert all files in a directory to unix
   </h2>
   <pre class="highlight"><code class="language-bash">dos2unix **/*</code></pre>
   <h2>
    recursively remove all whitespace from .py files
   </h2>
   <pre class="highlight"><code class="language-bash">find **/*.py -type f -exec sed -i 's/ *$//' '{}' ';'</code></pre>
   <h2>
    recursively autopep8
   </h2>
   <pre class="highlight"><code class="language-python">find . -name '*.py' -exec autopep8 --in-place '{}' \;</code></pre>
   <h2>
    make bash script a runnable command
   </h2>
   <p>
    include a shebang
   </p>
   <pre class="highlight"><code class="language-bash">#! /bin/bash</code></pre>
   <p>
    chmod
   </p>
   <pre class="highlight"><code class="language-bash">chmod +x /usr/local/bin/my_script</code></pre>
   <p>
    accept positional input
   </p>
   <pre class="highlight"><code class="language-bash">#! /bin/bash
input=$1
echo input</code></pre>
   <h1>
    Using pyp
   </h1>
   <pre class="highlight"><code class="language-bash">pipx install pyp</code></pre>
   <h2>
    replacement for cut
   </h2>
   <pre class="highlight"><code class="language-bash">‚ùØ python -m http.server 5000 &amp;
[1] 8574

‚ú¶ ‚ùØ Serving HTTP on 0.0.0.0 port 5000 (http://0.0.0.0:5000/) ...

‚ú¶ ‚ùØ ps aux | grep "python -m http.server" | grep -v grep | pyp 'line.split()[1]' | xargs kill
[1]  + terminated  python -m http.server 5000</code></pre>
   <h2>
    replacement for wc
   </h2>
   <pre class="highlight"><code class="language-bash">conda info --envs | pyp 'len(lines) - 3 # account for header and base'</code></pre>
   <h2>
    print contents of shell function
   </h2>
   <pre class="highlight"><code class="language-bash">declare -f &lt;function-name&gt;</code></pre>
   <h2>
    batch rename files
   </h2>
   <pre class="highlight"><code class="language-bash">for f in *.jpeg; do
    mv -- "$f" "${f%.jpeg}.jpg"
done</code></pre>
   <h2>
    convert markdown files to reveal.js
   </h2>
   <p>
    <a href="https://github.com/jgm/pandoc/wiki/Using-pandoc-to-produce-reveal.js-slides">
     https://github.com/jgm/pandoc/wiki/Using-pandoc-to-produce-reveal.js-slides
    </a>
    install pandoc
   </p>
   <pre class="highlight"><code class="language-bash">apt install pandoc</code></pre>
   <p>
    setup
   </p>
   <pre class="highlight"><code class="language-bash">wget https://github.com/hakimel/reveal.js/archive/master.tar.gz
tar -xzvf master.tar.gz
mv reveal.js-master reveal.js</code></pre>
   <p>
    convert
   </p>
   <pre class="highlight"><code class="language-bash">pandoc -t revealjs -s -o myslides.html myslides.md -V revealjs-url=https://unpkg.com/reveal.js@3.9.2/</code></pre>
   <h2>
    Render Markdown at the command line
   </h2>
   <p>
    <a href="https://github.com/charmbracelet/glow">
     Glow
    </a>
    is a terminal markdown renderer written in go.  There iis a prebuilt binary that can simply be unzipped and executed to render markdow.
   </p>
   <pre class="highlight"><code class="language-bash">wget https://github.com/charmbracelet/glow/releases/download/v0.2.0/glow_0.2.0_linux_x86_64.tar.gz
tar -xzf glow_0.2.0_linux_x86_64.tar.gz
chmod +x glow
sudo mv glow /usr/bin

glow &lt;filename&gt;</code></pre>
   <h2>
    Autocomplete for click applications
   </h2>
   <p>
    see the
    <a href="https://click.palletsprojects.com/en/7.x/bashcomplete/">
     docs
    </a>
    for more details
   </p>
   <h2>
    Autocomplete for non click python cli's
   </h2>
   <p>
    shtab
    <a href="https://github.com/iterative/shtab" title="https://github.com/iterative/shtab">
     https://github.com/iterative/shtab
    </a>
   </p>
   <h2>
    Ensure functions reset context
   </h2>
   <pre class="highlight"><code class="language-bash">project_log() {
   _dir=$(pwd)
   _project_log() {
      cd ~/projects/project
      git log
   }
   _project_log $@ &amp;&amp; cd $_dir || cd $_dir
}</code></pre>
   <div id="show">
   </div>
  </article>
 </body>
 <script>
  if ('serviceWorker' in navigator) {
  window.addEventListener('load', function() {
    navigator.serviceWorker.register('/service-worker.js').then(function(registration) {
      // Registration was successful
      console.log('ServiceWorker registration successful with scope: ', registration.scope);
    }, function(err) {
      // registration failed :(
      console.log('ServiceWorker registration failed: ', err);
    });
  });
}
 </script>
</html>